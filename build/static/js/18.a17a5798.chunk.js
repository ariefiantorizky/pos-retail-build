(this.webpackJsonpPOS_RETAIL=this.webpackJsonpPOS_RETAIL||[]).push([[18],{355:function(e,t,n){"use strict";var a=n(1),r=n.n(a),o=n(16),s=n.n(o),i=n(471),l=n(305),c=n.n(l);class d extends r.a.Component{render(){return null}}d.propsTypes={label:s.a.string.isRequired,value:s.a.oneOfType([s.a.number,s.a.bool,s.a.string,s.a.func]).isRequired};class h extends r.a.Component{render(){return null}}h.propsTypes={name:s.a.string.isRequired,data:s.a.arrayOf(s.a.object),dataSet:s.a.arrayOf(s.a.object),value:s.a.oneOfType([s.a.array,s.a.func]).isRequired,children:s.a.arrayOf(((e,t)=>{if(e[t]!==d)throw new Error("<ExcelSheet> can only have <ExcelColumn> as children")})).isRequired};const p=e=>{const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let a=0;a!==e.length;a+=1)n[a]=255&e.charCodeAt(a);return t},u=(e,t)=>{t&&(e+=1462);return(Date.parse(e)-new Date(Date.UTC(1899,11,30)))/864e5};function m(e,t,n){const a={v:e};if(null===e)return;const r=e instanceof Date;r||"object"!==typeof e||(a.s=e.style,a.v=e.value,e=e.value),"number"===typeof e?a.t="n":"boolean"===typeof e?a.t="b":r?(a.t="n",a.z=c.a.SSF.table[14],a.v=u(a.v)):a.t="s",n[t]=a}function f(e,t,n,a,r){e.s.r>t+a&&(e.s.r=t+a),e.s.c>n+r&&(e.s.c=n+r),e.e.r<t+a&&(e.e.r=t+a),e.e.c<n+r&&(e.e.c=n+r)}var x=n(13);class b extends r.a.Component{constructor(e){super(e),this.fileExtensions=["xlsx","xls","csv","txt","html"],this.defaultFileExtension="xlsx";const{hideElement:t}=this.props;t?this.download():this.handleDownload=this.download.bind(this),this.createSheetData=this.createSheetData.bind(this)}createSheetData(e){const t=e.props.children,n=[r.a.Children.map(t,(e=>e.props.label))];return("function"===typeof e.props.data?e.props.data():e.props.data).forEach((e=>{const a=[];r.a.Children.forEach(t,(t=>{const n=("function"===typeof t.props.value?t.props.value:e=>e[t.props.value])(e);a.push(isNaN(n)?n||"":n)})),n.push(a)})),n}download(){const{children:e}=this.props,t={SheetNames:r.a.Children.map(e,(e=>e.props.name)),Sheets:{}};r.a.Children.forEach(e,(e=>{"undefined"===typeof e.props.dataSet||0===e.props.dataSet.length?t.Sheets[e.props.name]=(e=>{const t={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let a=0;a!==e.length;++a)for(let r=0;r!==e[a].length;++r){n.s.r>a&&(n.s.r=a),n.s.c>r&&(n.s.c=r),n.e.r<a&&(n.e.r=a),n.e.c<r&&(n.e.c=r);const o={v:e[a][r]};if(null===o.v)continue;const s=c.a.utils.encode_cell({c:r,r:a});"number"===typeof o.v?o.t="n":"boolean"===typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=c.a.SSF.table[14],o.v=u(o.v)):o.t="s",t[s]=o}return n.s.c<1e7&&(t["!ref"]=c.a.utils.encode_range(n)),t})(this.createSheetData(e)):t.Sheets[e.props.name]=(e=>{if(void 0===e||0===e.length)return{};const t={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}};let a=0;return e.forEach((r=>{const{columns:o,data:s,xSteps:i,ySteps:l}=r,d="number"===typeof i?i:0,h="number"===typeof l?l:0;if(void 0===e||0===e.length)return;a+=h;const p=[];o.length>=0&&(o.forEach(((e,r)=>{const o=c.a.utils.encode_cell({c:d+r,r:a});f(n,0,0,a,d),"object"===typeof e&&p.push(e.width||{wpx:80}),function(e,t,n){const a={},r={font:{bold:!0}},o={...e.style,...r};a.v=e.title,a.t="s",a.s=o,n[t]=a}(e,o,t)})),a+=1),p.length>0&&(t["!cols"]=p);for(let e=0;e!==s.length;++e,a++)for(let r=0;r!==s[e].length;++r){const o=c.a.utils.encode_cell({c:r+d,r:a});f(n,e,r,a,d),m(s[e][r],o,t)}})),n.s.c<1e7&&(t["!ref"]=c.a.utils.encode_range(n)),t})(e.props.dataSet)}));const n=this.getFileExtension(),a=this.getFileName(),o=c.a.write(t,{bookType:n,bookSST:!0,type:"binary"});Object(i.saveAs)(new Blob([p(o)],{type:"application/octet-stream"}),a)}getFileName(){const{filename:e}=this.props;if(null===e||"string"!==typeof e)throw Error("Invalid file name provided");return this.getFileNameWithExtension(e,this.getFileExtension())}getFileExtension(){const{fileExtension:e,filename:t}=this.props;let n=e;if(0===n.length){const e=t.split(".");if(0===e.length)throw Error("Invalid file name provided");n=e[e.length-1]}return-1!==this.fileExtensions.indexOf(n)?n:this.defaultFileExtension}getFileNameWithExtension(e,t){return"".concat(e,".").concat(t)}render(){const{hideElement:e,element:t}=this.props;return e?null:Object(x.jsx)("span",{onClick:this.handleDownload,children:t})}}b.props={hideElement:s.a.bool,filename:s.a.string,fileExtension:s.a.string,element:s.a.any,children(e,t){r.a.Children.forEach(e[t],(e=>{if(e.type!==h)throw new Error("<ExcelFile> can only have <ExcelSheet> as children. ")}))}},b.defaultProps={hideElement:!1,filename:"excel",fileExtension:"xlsx",element:Object(x.jsx)("button",{children:"Excel"})};var y=b;y.ExcelSheet=h,y.ExcelColumn=d;const j={ExcelFile:y,ExcelSheet:h,ExcelColumn:d};t.a=j},479:function(e,t){},480:function(e,t){},485:function(e,t){},486:function(e,t){},491:function(e,t){},492:function(e,t){},494:function(e,t){},497:function(e,t){},499:function(e,t){},502:function(e,t){},503:function(e,t){},505:function(e,t){},842:function(e,t,n){"use strict";n.r(t);n(354);var a=n(352),r=(n(197),n(86)),o=(n(196),n(140)),s=(n(110),n(64)),i=n(1),l=n.n(i),c=n(28),d=n(76),h=n(48),p=n(148),u=n(41),m=n(355),f=n(13);const{ExcelFile:x}=m.a,{ExcelSheet:b}=x,y={alignment:{horizontal:"right"}},j=[{title:"Kode_Produk",width:{wch:15}},{title:"Nama_Produk",width:{wch:30}},{title:"Kategori_Produk",width:{wch:20}},{title:"Qty",width:{wch:10},style:y},{title:"Harga",width:{wch:15},style:y},{title:"Total",width:{wch:15},style:y}],g=[{title:"",width:{wch:10}}];class v extends l.a.Component{render(){const{dataitem:e=[],filename:t,date:n}=this.props,a={numFmt:"#,##0.00;(#,##0.00)",...y},r=[[{value:t,style:{font:{bold:!0}}}],[{value:"DATE ".concat(n),style:{font:{bold:!0}}}]],o=(e||[]).map((e=>[{value:e.ItemCode||""},{value:e.ItemName||""},{value:e.CateName||""},{value:+e.QtySi||0,style:{...a}},{value:+e.UnitPrice||0,style:{...a}},{value:+e.Amount||0,style:{...a}}])),i=[{columns:g,data:r},{columns:j,data:o,ySteps:3}];return Object(f.jsx)("div",{children:Object(f.jsx)(x,{filename:"".concat(t,"_").concat(n),element:Object(f.jsx)(s.a,{...this.props,children:"Excel"}),children:Object(f.jsx)(b,{dataSet:i,name:t})})})}}var E,S,w=v,O=n(85);let I=(E=Object(h.c)((e=>{let{transaction:t,report:n}=e;return{transaction:t,report:n,contentStatus:t.contentStatus,reportSalesItem:n.reportSalesItem}})),Object(c.withRouter)(S=E(S=class extends i.Component{constructor(e){super(e),this.handleSearch=()=>{const{dispatch:e}=this.props,{from:t,to:n}=this.state,a={from:t,to:n};e({type:u.a.REPORT_SALES_ITEM,payload:a})},this.componentRef=l.a.createRef(),this.state={modalReturn:!1,from:p().startOf("month").format("YYYY-MM-DD"),to:p().format("YYYY-MM-DD")}}componentWillUnmount(){const{dispatch:e}=this.props;e({type:u.a.SET_STATE,payload:{reportSalesItem:[]}})}render(){const{from:e,to:t}=this.state,{reportSalesItem:n,report:{loadingReportItem:i}}=this.props,l=[{title:"Kode Produk",dataIndex:"ItemCode",key:"ItemCode",width:100},{title:"Nama Produk",dataIndex:"ItemName",key:"ItemName",width:250},{title:"Kategori Produk",dataIndex:"CateName",key:"CateName",width:250},{title:"Qty",dataIndex:"QtySi",key:"QtySi",align:"right",width:100,render:e=>Object(O.a)(e,0)},{title:"Harga",dataIndex:"UnitPrice",key:"UnitPrice",align:"right",width:150,render:e=>Object(O.a)(e,0)},{title:"Diskon",dataIndex:"DiscVal",key:"DiscVal",align:"right",width:150,render:e=>Object(O.a)(e,0)},{title:"Total",dataIndex:"Amount",key:"Amount",align:"right",width:150,render:e=>Object(O.a)(e,0)}];return Object(f.jsxs)("div",{className:"container mx-auto p-4 h-screen",children:[Object(f.jsxs)("div",{children:[Object(f.jsx)(d.b,{to:"/kasir",children:Object(f.jsx)(s.a,{className:"bg-green-500 text-white rounded leading-3",children:"ORDER BARU"})}),Object(f.jsx)(d.b,{to:"/pos/report",children:Object(f.jsx)(s.a,{className:"bg-green-500 text-white rounded leading-3 ml-4",children:"LAPORAN"})})]}),Object(f.jsx)("div",{className:"mt-4",children:Object(f.jsxs)(r.a,{layout:"inline",children:[Object(f.jsx)(r.a.Item,{label:"Tanggal ",children:Object(f.jsx)(o.a,{value:e,type:"date",onChange:e=>this.setState({from:e.target.value})})}),Object(f.jsx)(r.a.Item,{label:"",children:Object(f.jsx)(o.a,{value:t,type:"date",onChange:e=>this.setState({to:e.target.value})})}),Object(f.jsx)(r.a.Item,{children:Object(f.jsx)(s.a,{type:"primary",onClick:this.handleSearch,children:"Cari"})}),Object(f.jsx)(r.a.Item,{children:Object(f.jsx)(w,{filename:"Laporan_Penjualan_By_Item",type:"primary",date:"".concat(e,"_").concat(t),dataitem:n})})]})}),Object(f.jsx)("div",{className:"mt-4",children:Object(f.jsx)(a.a,{dataSource:n,columns:l,size:"small",loading:i,scroll:{y:400}})})]})}})||S)||S);t.default=I}}]);
//# sourceMappingURL=18.a17a5798.chunk.js.map