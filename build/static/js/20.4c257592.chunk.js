(this.webpackJsonpPOS_RETAIL=this.webpackJsonpPOS_RETAIL||[]).push([[20],{396:function(e,t,l){"use strict";l.d(t,"a",(function(){return s}));var a=l(59);function s(){const e=Object(a.d)(),{billNo:t="",billDate:l="",data:s=[]}=Object(a.e)((e=>null===e||void 0===e?void 0:e.transaction)),{cashier:n={},property:c={}}=JSON.parse(localStorage.getItem("app")||"{}"),r=()=>(null===s||void 0===s?void 0:s.reduce(((e,t)=>{let{total:l=0}=t;return+e+ +l}),0))||0,i=()=>0,d=()=>r()-0,o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 0!==(null===e||void 0===e?void 0:e.length)?e.reduce(((e,t)=>+e+ +t.cashPay),0):0},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const l=d(),a=o(e);return 0===l?0:t>l?t-l:a>l?a-l:0};return{getTotalQty:()=>(null===s||void 0===s?void 0:s.reduce(((e,t)=>{let{qty:l=0}=t;return+e+ +l}),0))||0,getDiscountTotal:i,getSubtotal:r,getGrandTotal:d,getCashPaid:o,getCashChange:u,getBalanceDue:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=u(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),l=o(e),a=d();return l>=a?l-a-t:d()-+l},paymentStore:(a,i)=>{var o,j;const m={header:[{billNo:t,billDate:l,custCode:"",custName:"",discPrc:"0",discValue:"0",taxPrc:"0",taxValue:"0",subTotal:r(),grandTotal:d(),shiftID:(null===n||void 0===n?void 0:n.shiftId)||"0",outletCode:null===c||void 0===c?void 0:c.outletCode}],settle:0!==(null===(o=a.settles)||void 0===o?void 0:o.length)&&(null===(j=a.settles)||void 0===j?void 0:j.map((e=>({...e,cashChange:u(null===a||void 0===a?void 0:a.settles,null===e||void 0===e?void 0:e.cashPay)})))),details:null===s||void 0===s?void 0:s.map(((e,l)=>({...e,billNo:t,ItemNo:l+1})))};e({type:"transaction/STORE",payload:m,bill:{from:l,to:l},handlePrint:i})}}}},549:function(e,t,l){"use strict";l.d(t,"a",(function(){return j}));l(290);var a=l(292),s=(l(291),l(293)),n=l(149),c=l.n(n),r=l(0),i=l.n(r),d=l(59),o=l(86),u=l(13);const j=i.a.forwardRef(((e,t)=>{const{transactions:l=[],cash:n={},billDate:i="",billNo:j=null,paymentMethod:m="",isReprintBill:h=!1,payments:x=[]}=e,[b,p]=Object(r.useState)({}),{billNo:v}=Object(d.e)((e=>null===e||void 0===e?void 0:e.transaction)),{loading:O=!1}=Object(d.e)((e=>null===e||void 0===e?void 0:e.auth));Object(r.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("app")||"{}"),{property:t={},user:l={}}=e;p({...t,cashier:(null===l||void 0===l?void 0:l.username)||""}||{})}),[t]);const f=null===l||void 0===l?void 0:l.reduce(((e,t)=>{let{total:l=0}=t;return+e+ +l}),0);return Object(u.jsx)("div",{className:"w-full h-full rounded-md mx-auto",children:Object(u.jsxs)("div",{className:"w-full h-auto bg-white p-3 py-7 mx-auto",style:{maxWidth:"350px"},ref:t,children:[O?Object(u.jsx)("p",{className:"text-left text-print-xsmall text-gray-500",children:"Memuat data..."}):Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{className:"text-center text-print-medium font-bold",children:(null===b||void 0===b?void 0:b.header1)||""}),Object(u.jsx)("p",{className:"text-center text-print-small font-semibold",children:(null===b||void 0===b?void 0:b.header2)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall mt-2",children:(null===b||void 0===b?void 0:b.header3)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:(null===b||void 0===b?void 0:b.header4)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:(null===b||void 0===b?void 0:b.header5)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:(null===b||void 0===b?void 0:b.header6)||""}),h&&Object(u.jsx)("p",{className:"text-center text-print-small mt-3 font-semibold",children:"THIS IS COPY / REPRINT"})]}),Object(u.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),Object(u.jsxs)(a.a,{children:[Object(u.jsx)(s.a,{span:7,children:Object(u.jsx)("p",{className:"text-left text-print-xsmall",children:"Tanggal/Waktu"})}),Object(u.jsx)(s.a,{span:2,children:Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:":"})}),Object(u.jsx)(s.a,{span:15,children:Object(u.jsx)("p",{className:"text-left text-print-xsmall",children:c()(i).format("ddd, DD MMMM YYYY LTS")})})]}),Object(u.jsxs)(a.a,{className:"my-1",children:[Object(u.jsx)(s.a,{span:7,children:Object(u.jsx)("p",{className:"text-left text-print-xsmall",children:"No. Transaksi"})}),Object(u.jsx)(s.a,{span:2,children:Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:":"})}),Object(u.jsx)(s.a,{span:15,children:Object(u.jsx)("p",{className:"text-left text-print-xsmall",children:j||v||"-"})})]}),Object(u.jsxs)(a.a,{children:[Object(u.jsx)(s.a,{span:7,children:Object(u.jsx)("p",{className:"text-left text-print-xsmall",children:"Kasir"})}),Object(u.jsx)(s.a,{span:2,children:Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:":"})}),Object(u.jsx)(s.a,{span:15,children:Object(u.jsx)("p",{className:"text-left text-print-xsmall",children:(null===b||void 0===b?void 0:b.cashier)||""})})]}),Object(u.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),0===(null===l||void 0===l?void 0:l.length)&&Object(u.jsx)("p",{className:"text-left text-print-xsmall text-gray-500",children:"Tidak ada transaksi"}),null===l||void 0===l?void 0:l.map(((e,t)=>{let{ItemName:l="",qty:n=0,price:c=0,total:r=0}=e;return Object(u.jsxs)(a.a,{wrap:!0,gutter:[2,2],className:"mb-2",children:[Object(u.jsx)(s.a,{span:24,children:Object(u.jsx)("p",{className:"text-left text-print-xsmall",children:l||""})}),Object(u.jsx)(s.a,{span:8,children:Object(u.jsxs)("p",{className:"text-left text-print-xsmall",children:["Rp ",Object(o.a)(c||0,0)||""]})}),Object(u.jsx)(s.a,{span:8,children:Object(u.jsxs)("p",{className:"text-center text-print-xsmall",children:[n||"","x"]})}),Object(u.jsx)(s.a,{span:8,children:Object(u.jsxs)("p",{className:"text-right text-print-xsmall",children:["Rp ",Object(o.a)((r||0).toString(),0)||"0"]})})]},t)})),Object(u.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),0===(null===x||void 0===x?void 0:x.length)?Object(u.jsxs)(a.a,{className:"my-1",children:[Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall",children:"Pembayaran"})}),Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall uppercase",children:(m||"-").trim().toUpperCase()})})]}):null===x||void 0===x?void 0:x.map(((e,t)=>{var l,n;let{cashPay:c,tenderName:r}=e;return Object(u.jsxs)(a.a,{className:"my-1",children:[Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall capitalize",children:null===(l=r||"")||void 0===l?void 0:l.trim()})}),Object(u.jsx)(s.a,{span:12,children:Object(u.jsxs)("p",{className:"text-right text-print-xsmall uppercase",children:["Rp ",null===(n=Object(o.a)(c,0)||"")||void 0===n?void 0:n.trim()]})})]})})),Object(u.jsxs)(a.a,{className:"my-1",children:[Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall",children:"Subtotal"})}),Object(u.jsx)(s.a,{span:12,children:Object(u.jsxs)("p",{className:"text-right text-print-xsmall",children:["Rp ",Object(o.a)(f||"0",0)]})})]}),Object(u.jsxs)(a.a,{className:"my-1",children:[Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall",children:"Diskon"})}),Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall",children:"Rp 0"})})]}),Object(u.jsxs)(a.a,{className:"my-1",children:[Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall",children:"Total"})}),Object(u.jsx)(s.a,{span:12,children:Object(u.jsxs)("p",{className:"text-right text-print-xsmall",children:["Rp ",Object(o.a)(f||"0",0)]})})]}),Object(u.jsxs)(a.a,{className:"my-1",children:[Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall",children:"Bayar"})}),Object(u.jsx)(s.a,{span:12,children:Object(u.jsxs)("p",{className:"text-right text-print-xsmall",children:["Rp ",Object(o.a)((null===n||void 0===n?void 0:n.cashPaid)||"0",0)]})})]}),Object(u.jsxs)(a.a,{className:"my-1",children:[Object(u.jsx)(s.a,{span:12,children:Object(u.jsx)("p",{className:"text-right text-print-xsmall",children:"Kembalian"})}),Object(u.jsx)(s.a,{span:12,children:Object(u.jsxs)("p",{className:"text-right text-print-xsmall",children:["Rp ",Object(o.a)((null===n||void 0===n?void 0:n.cashChange)||"0",0)]})})]}),O?Object(u.jsx)("p",{className:"text-left text-print-xsmall text-gray-500",children:"Memuat data..."}):Object(u.jsxs)("div",{className:"mt-7",children:[Object(u.jsx)("p",{className:"text-center text-print-xsmall font-semibold",children:(null===b||void 0===b?void 0:b.footer1)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:(null===b||void 0===b?void 0:b.footer2)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:(null===b||void 0===b?void 0:b.footer3)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:(null===b||void 0===b?void 0:b.footer4)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:(null===b||void 0===b?void 0:b.footer5)||""}),Object(u.jsx)("p",{className:"text-center text-print-xsmall",children:(null===b||void 0===b?void 0:b.footer6)||""})]})]})})}))},559:function(e,t,l){},709:function(e,t,l){"use strict";l.r(t),l.d(t,"default",(function(){return P}));l(688);var a=l(695),s=(l(108),l(20)),n=(l(194),l(85)),c=l(0),r=l.n(c),i=l(549),d=l(59),o=l(402),u=l(548),j=l(12),m=l(86),h=(l(559),l(150),l(71)),x=(l(138),l(68)),b=l(396),p=l(13);function v(e){const t=r.a.createRef(),{handlePaymentStore:l=(e=>{}),state:a={},setState:s=null,open:n=!1}=e,{getCashChange:i}=Object(b.a)(),d=()=>{t&&t.current&&null!==t.current&&t.current.focus()},o=e=>{if(e.preventDefault(),document.activeElement===t.current&&"tender-media"!==e.target.id)return l(e),void u()},u=()=>{s({...a,modalCashChange:!1,modalCash:!0,cashPaid:0})},j=e=>{const l=t&&t.current&&null!==t.current&&t.current;d(),"Enter"!==e.key||document.activeElement!==l||o(e)};return Object(c.useEffect)((()=>(d(),document.addEventListener("keydown",j),()=>{document.addEventListener("keydown",j)})),[t]),Object(p.jsx)(h.a,{centered:!0,width:450,footer:!1,onCancel:u,open:n,bodyStyle:{backgroundColor:"#f8f8f8"},children:Object(p.jsxs)("div",{className:"w-full h-48 flex items-center justify-center flex-col gap-3",children:[Object(p.jsx)("h1",{className:"text-lg font-medium text-gray-700",children:"KEMBALIAN PELANGGAN"}),Object(p.jsxs)("p",{className:"text-3xl font-bold",children:["Rp ",Object(m.a)(i(null===a||void 0===a?void 0:a.settles,null===a||void 0===a?void 0:a.cashPaid),0)]}),Object(p.jsx)(x.a,{autoFocus:!0,ref:t,className:"w-1/2 btn-page h-14 mt-7",onClick:o,children:"PRINT BILL"})]})})}function O(e){let{state:t}=e;const{getSubtotal:l,getDiscountTotal:a}=Object(b.a)();return Object(p.jsxs)("div",{className:"w-full h-full",children:[Object(p.jsx)("h1",{className:"text-base font-semibold",children:"Detail Transaksi"}),Object(p.jsx)("div",{className:"w-full bg-gray-400 mt-2 mb-2",style:{height:"1.5px"}}),Object(p.jsx)("table",{className:"w-full",children:Object(p.jsxs)("tbody",{children:[Object(p.jsxs)("tr",{className:"w-full h-6",children:[Object(p.jsx)("td",{className:"w-1/2 text-sm uppercase font-semibold text-gray-800",children:"Subtotal"}),Object(p.jsx)("td",{className:"text-sm uppercase font-medium text-gray-800",children:":"}),Object(p.jsxs)("td",{className:"w-1/2 pl-2 text-sm uppercase font-medium text-gray-800",children:["idr ",Object(m.a)(l(),0)]})]}),Object(p.jsxs)("tr",{className:"w-full h-6",children:[Object(p.jsx)("td",{className:"w-1/2 text-sm uppercase font-semibold text-gray-800",children:"Diskon"}),Object(p.jsx)("td",{className:"text-sm uppercase font-medium text-gray-800",children:":"}),Object(p.jsxs)("td",{className:"w-1/2 pl-2 text-sm uppercase font-medium text-gray-800",children:["idr ",Object(m.a)(a(),0)]})]}),Object(p.jsxs)("tr",{className:"w-full h-6",children:[Object(p.jsx)("td",{className:"w-1/2 text-sm uppercase font-semibold text-gray-800",children:"PPN 11%"}),Object(p.jsx)("td",{className:"text-sm uppercase font-medium text-gray-800",children:":"}),Object(p.jsx)("td",{className:"w-1/2 pl-2 text-sm uppercase font-medium text-gray-800",children:"idr 0"})]})]})})]})}l(193);var f=l(139);function g(e){var t,l;let{state:a,setState:s,handlePaymentList:r,handleFocus:i}=e;const[d]=n.a.useForm(),o=Object(c.useRef)(null),u=Object(c.useRef)(null),j=Object(c.useRef)(null),m=()=>{s((e=>({...e,modalCard:!1}))),d.resetFields(),i()},b=e=>{"ArrowUp"===e.key&&v(),"ArrowDown"===e.key&&u.current&&document.activeElement===u.current.input&&(u&&u.current.blur(),j&&j.current.focus()),"Enter"===e.key&&u.current&&document.activeElement===u.current.input&&(u&&u.current.blur(),j&&j.current.focus())},v=()=>u&&u.current&&u.current.focus();return Object(c.useEffect)((()=>{v();if(o&&null!==o.current)return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}}),[null===a||void 0===a?void 0:a.modalCard,o]),Object(p.jsx)(h.a,{open:null===a||void 0===a?void 0:a.modalCard,onCancel:m,centered:!0,width:650,footer:null,children:Object(p.jsxs)("div",{ref:o,autoFocus:!0,onKeyDown:b,className:"w-full h-full",children:[Object(p.jsx)("h1",{className:"text-lg font-semibold mb-5",children:"MASUKKAN KARTU"}),Object(p.jsxs)(n.a,{layout:"vertical",onFinish:()=>{r(null===a||void 0===a?void 0:a.tender),m(),i()},form:d,name:"card-form",children:[Object(p.jsx)(n.a.Item,{name:"cardName",label:Object(p.jsxs)("p",{children:["Nama Kartu / Provider ",Object(p.jsx)("kbd",{className:"kbd",children:"\u2191"})]}),rules:[{required:!0,message:"Wajib Diisi!"}],children:Object(p.jsx)(f.a,{autoFocus:!0,ref:u,placeholder:"Card Holder / Name",value:null===a||void 0===a||null===(t=a.card)||void 0===t?void 0:t.name,onChange:e=>{const t=e.target.value;s((e=>({...e,card:{...e.card,name:t}})))},className:"w-full h-14 rounded-md"})}),Object(p.jsx)(n.a.Item,{name:"cardNo",label:Object(p.jsxs)("p",{children:["Nomor Kartu ",Object(p.jsx)("kbd",{className:"kbd",children:"\u2193"})]}),rules:[{required:!0,message:"Wajib Diisi!"}],children:Object(p.jsx)(f.a,{ref:j,placeholder:"Card Number",value:null===a||void 0===a||null===(l=a.card)||void 0===l?void 0:l.no,onChange:e=>{const t=e.target.value;s((e=>({...e,card:{...e.card,no:t}})))},className:"w-full h-14 rounded-md"})}),Object(p.jsx)(n.a.Item,{children:Object(p.jsxs)("div",{className:"w-full flex items-center justify-end gap-3",children:[Object(p.jsx)(x.a,{htmlType:"button",className:"h-14 px-5 rounded-md uppercase",onClick:m,children:"Batalkan"}),Object(p.jsx)(x.a,{htmlType:"submit",className:"btn-page h-12 w-max px-7",children:"Bayar"})]})})]})]})})}var N=l(561);function y(e){let{state:t,setState:l,handleFocus:a}=e;const[s,n]=Object(c.useState)(0),r=Object(c.useRef)(null),i=(null===t||void 0===t?void 0:t.settles)||[],d=e=>{if("F4"===e.key)e.target.blur(),e.preventDefault(),r&&r.current.focus()},o=e=>{var t;switch(e.key){case"ArrowUp":n((e=>Math.max(e-1,0)));break;case"ArrowDown":n((e=>Math.min(e+1,i.length-1)));break;case"Enter":const l=null===(t=i[s])||void 0===t?void 0:t.settleCode;l&&u(l);break;case"Escape":e.target.blur(),a()}};Object(c.useEffect)((()=>(r.current&&r.current.focus(),document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)})),[]),Object(c.useEffect)((()=>{const e=r.current;if(e)return e.addEventListener("keydown",o),()=>{e.removeEventListener("keydown",o)}}),[i,s]);const u=e=>{const s=null===t||void 0===t?void 0:t.settles;l({settles:null===s||void 0===s?void 0:s.filter((t=>t.settleCode!==e))}),r.current.focus(),a()};return Object(p.jsxs)("div",{className:"w-full h-full relative",children:[Object(p.jsxs)("h1",{className:"mb-3 text-lg font-semibold",children:["Alokasi Pembayaran ",Object(p.jsx)("kbd",{className:"kbd",children:"F4"})]}),Object(p.jsxs)("table",{ref:r,tabIndex:0,className:"table-fixed w-full",border:!0,children:[Object(p.jsx)("thead",{className:"w-full h-14 bg-primary sticky top-0",children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{className:"w-10 text-center",children:"#"}),Object(p.jsx)("th",{className:"w-1/2 text-left px-3 text-white",children:"Payment Type"}),Object(p.jsx)("th",{className:"w-1/2 text-right px-3 text-white",children:"Amount"})]})}),Object(p.jsx)("tbody",{children:i.map(((e,t)=>{let{cashPay:l=0,tenderName:a="",settleCode:n=""}=e;return Object(p.jsxs)("tr",{className:"w-full h-14 border border-gray-500 ".concat(t===s?"bg-yellow-200":""),children:[Object(p.jsx)("td",{className:"w-10 text-center",children:Object(p.jsx)(x.a,{icon:Object(p.jsx)(N.b,{className:"text-white"}),type:"primary",className:"flex items-center justify-center mx-auto",shape:"circle",danger:!0,onClick:()=>u(n)})}),Object(p.jsx)("td",{className:"w-1/2 text-left px-3 text-black",children:a.trim().toUpperCase()}),Object(p.jsxs)("td",{className:"w-1/2 text-right px-3 text-black",children:["Rp ",Object(m.a)(l)]})]},n)}))})]})]})}var w=l(27);function k(e){let{form:t,state:l,setState:a,handleClickTender:s,handleFocus:n}=e;const r=Object(w.useHistory)(),{tenderMedia:i=[],data:o=[]}=Object(d.e)((e=>null===e||void 0===e?void 0:e.transaction)),{getBalanceDue:u,getGrandTotal:j}=Object(b.a)(),m=Object(c.useRef)(),h=Object(c.useRef)([]),[v,O]=Object(c.useState)(-1),f=()=>r.push("/pos/kasir"),g=()=>{const e=u(null===l||void 0===l?void 0:l.settles,null===l||void 0===l?void 0:l.cashPaid);a((t=>({...t,cashPaid:e}))),t.setFieldValue("cashPaid",e),n()},N=e=>{const t=e.key;"F1"===t&&(e.preventDefault(),g()),"F3"===t&&(e.preventDefault(),O(0),m&&m.current.focus()),"Escape"===t&&(e.target.blur(),n()),"End"===t&&f()},y=e=>{const t=e.key;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter"].includes(t)){e.preventDefault();let l=v;const a=3;"ArrowLeft"===t?v%a===0?l=v+(a+1):l-=1:"ArrowRight"===t?(v+1)%a===0?l=v-(a-1):l+=1:"ArrowUp"===t?v-a<0?l=(i.length-a+v%a)%i.length:l-=1:"ArrowDown"===t?v+a>=i.length?l=(i.length-a+v%a)%i.length:l+=1:"Enter"===t&&s(i[v]),O(l),h.current[l]&&h.current[l].scrollIntoView({behavior:"smooth",block:"center"})}};return Object(c.useEffect)((()=>(document.addEventListener("keydown",N),0===o.length&&f(),()=>{document.removeEventListener("keydown",N)})),[]),Object(c.useEffect)((()=>{const e=m&&null!==m.current?m.current:null;if(e)return e.addEventListener("keydown",y),()=>{e.removeEventListener("keydown",y)}}),[v,i]),Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{ref:m,tabIndex:-1,id:"tender-media",className:"w-full h-full overflow-y-scroll overflow-x-hidden ",children:[Object(p.jsxs)("h1",{className:"mb-3 text-lg font-semibold",children:["Metode Pembayaran ",Object(p.jsx)("kbd",{className:"kbd",children:"f3"})]}),Object(p.jsxs)("div",{className:"w-full h-auto grid grid-cols-3 gap-3",children:[Object(p.jsxs)(x.a,{className:"col-span-1 btn-page bg-transparent border-2 border-red-500 text-red-600",onClick:f,children:["batalkan ",Object(p.jsx)("kbd",{className:"kbd",children:"end"})]}),Object(p.jsxs)(x.a,{className:"col-span-2 btn-page",onClick:g,children:["uang pas ",Object(p.jsx)("kbd",{className:"kbd",children:"f1"})]}),0!==(null===i||void 0===i?void 0:i.length)&&(null===i||void 0===i?void 0:i.map(((e,t)=>{const{settleCode:a,tenderName:n}=e,c=0!==(null===l||void 0===l?void 0:l.settles.length)?null===l||void 0===l?void 0:l.settles.filter((e=>(null===e||void 0===e?void 0:e.settleCode)===a)):[],r=0!==(null===c||void 0===c?void 0:c.length)&&c[0].settleCode===a||(null===l||void 0===l?void 0:l.cashPaid)<1||0===(null===o||void 0===o?void 0:o.length)||0!==(null===l||void 0===l?void 0:l.settles.length)||0===j();return Object(p.jsx)(x.a,{ref:e=>h.current[t]=e,className:"btn-page ".concat(t===v?"active":""),disabled:r,onClick:()=>{r||s(e)},children:n.trim().toUpperCase()},a)})))]})]})})}function P(){var e;const t=Object(o.useHistory)(),l=Object(d.d)();let r=Object(c.useRef)(null);const h=Object(c.useRef)(null),{billNo:x="",data:f=[]}=Object(d.e)((e=>null===e||void 0===e?void 0:e.transaction)),{getSubtotal:N,getGrandTotal:w,getCashPaid:P,getCashChange:C,getBalanceDue:E,paymentStore:S}=Object(b.a)(),{cashier:T={}}=JSON.parse(localStorage.getItem("app")||"{}"),[R]=n.a.useForm(),[D,A]=Object(c.useState)({cashPaid:0,cashChange:0,card:{name:"",no:""},settles:[],subtotal:N(),grandTotal:w(),modalCash:!1,modalCard:!1,modalCashChange:!1,tender:{}}),I=e=>{const{settleCode:t="",tenderName:l="",paidType:a=""}=e,s={billNo:x,custCode:"",custName:"",paidType:a,settleCode:t,amount:w(),amountPaid:(null===D||void 0===D?void 0:D.cashPaid)||0,cashPay:(null===D||void 0===D?void 0:D.cashPaid)||0,cashChange:w()-(null===D||void 0===D?void 0:D.cashPaid)||0,tenderName:l,cardName:2===+a?null===D||void 0===D?void 0:D.card.name:"",cardHolder:2===+a?null===D||void 0===D?void 0:D.card.name:"",cardNo:2===+a?null===D||void 0===D?void 0:D.card.no:""};A((e=>({...e,settles:[...e.settles,s],cashPaid:0}))),L(),h.current.value="0",R.resetFields()},L=()=>{h&&null!==h.current&&(h.current.focus(),h.current.select())},F=Object(u.useReactToPrint)({content:()=>r,onPrintError:e=>console.log("Error Print!",e),onAfterPrint:()=>{l({type:j.a.SET_STATE,payload:{contentStatus:"isMenu"}}),t.push("/pos/kasir")}}),M=()=>S(D,F(null,(()=>r))),B=e=>{"F2"===e.key&&L()};return Object(c.useEffect)((()=>{l({type:"transaction/TENDER_MEDIA"}),null!==T&&void 0!==T&&T.isOpening||(t.push("/pos"),s.a.error({message:"Error!",description:"Mohon untuk melakukan Buka Kasir terlebih dahulu sebelum melanjutkan transaksi."}))}),[]),Object(c.useEffect)((()=>(L(),document.addEventListener("keydown",B),()=>{document.removeEventListener("keydown",B)})),[]),Object(c.useEffect)((()=>{0===(null===f||void 0===f?void 0:f.length)||0===(null===D||void 0===D?void 0:D.settles.length)?s.a.error({message:"Perhatian!",description:"Anda tidak dapat melakukan transaksi jika tidak ada item yang dibeli atau quantity 0"}):(()=>{const e=(null===D||void 0===D?void 0:D.settles)||[];C(e,null===D||void 0===D?void 0:D.cashPaid)>0?A((e=>({...e,modalCashChange:!0}))):(()=>{return 0===e.length?0:1===e.length?null===(t=e[0])||void 0===t?void 0:t.cashPay:e.length>1?e.reduce(((e,t)=>e+t.cashPay),0):void 0;var t})()>=w()&&M()})()}),[null===D||void 0===D?void 0:D.settles]),Object(p.jsxs)("div",{className:"w-screen h-screen overflow-x-hidden overflow-y-scroll",children:[Object(p.jsxs)("div",{className:"w-full h-full grid grid-cols-12 grid-rows-6 gap-3 p-3",children:[Object(p.jsx)("div",{className:"col-span-3 row-span-5 bg-white overflow-scroll p-3 rounded-md border-2 border-gray-400",children:Object(p.jsx)("div",{className:"w-full h-full",children:Object(p.jsx)(i.a,{ref:e=>r=e,transactions:f,cash:{cashChange:C(null===D||void 0===D?void 0:D.settles,null===D||void 0===D?void 0:D.cashPaid),cashPaid:P(null===D||void 0===D?void 0:D.settles),total:null===D||void 0===D?void 0:D.grandTotal},billDate:new Date,payments:null===D||void 0===D?void 0:D.settles,paymentMethod:null===D||void 0===D||null===(e=D.settles[0])||void 0===e?void 0:e.tenderName})})}),Object(p.jsxs)("div",{className:"col-span-9 row-span-1 bg-primary rounded-md",children:[Object(p.jsxs)("div",{className:"w-full h-full p-5 flex flex-row items-center justify-between gap-3",children:[Object(p.jsx)("h1",{className:"text-lg text-white",children:"Total Belanja"}),Object(p.jsxs)("h1",{className:"text-4xl text-white font-semibold capitalize",children:["Rp ",Object(m.a)(null===D||void 0===D?void 0:D.grandTotal,0)]})]}),"."]}),Object(p.jsx)("div",{className:"col-span-9 row-span-1",children:Object(p.jsxs)("div",{className:"w-full h-full flex items-center gap-3",children:[Object(p.jsxs)("div",{className:"w-full h-full bg-white rounded-md p-3 flex flex-col items-center justify-center",children:[Object(p.jsx)("h1",{children:"Kembalian"}),Object(p.jsxs)("h1",{className:"text-2xl font-semibold capitalize",children:["IDR ",Object(m.a)(C(null===D||void 0===D?void 0:D.settles,null===D||void 0===D?void 0:D.cashPaid),0)]})]}),Object(p.jsxs)("div",{className:"w-full h-full bg-white rounded-md p-3 flex flex-col items-center justify-center",children:[Object(p.jsx)("h1",{children:"Sisa Bayar"}),Object(p.jsxs)("h1",{className:"text-2xl font-semibold capitalize",children:["IDR ",Object(m.a)(E(null===D||void 0===D?void 0:D.settles,null===D||void 0===D?void 0:D.cashPaid),0)]})]})]})}),Object(p.jsx)("div",{className:"col-span-9 row-span-1",children:Object(p.jsx)("div",{className:"w-full h-full bg-gray-800 rounded-md overflow-hidden",children:Object(p.jsx)(n.a,{form:R,name:"cash-paid-form",children:Object(p.jsx)(n.a.Item,{name:"cashPaid",initialValue:0,children:Object(p.jsx)(a.a,{disabled:!(null!==T&&void 0!==T&&T.isOpening),name:"cashPaid",ref:h,autoFocus:!0,value:null===D||void 0===D?void 0:D.cashPaid,formatter:e=>"IDR ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>null===e||void 0===e?void 0:e.replace(/IDR\s?|(,*)/g,""),onChange:e=>{A({...D,cashPaid:e})},className:"w-full h-96 p-5 flex items-center bg-transparent text-4xl text-white font-bold border-none focus:outline-none",onPressEnter:e=>{L()}})})})})}),Object(p.jsx)("div",{className:"col-span-9 row-span-6",children:Object(p.jsxs)("div",{className:"w-full h-full overflow-hidden grid grid-cols-2 gap-5",children:[Object(p.jsx)("div",{className:"w-full h-full overflow-scroll",children:Object(p.jsx)(k,{form:R,state:D,setState:A,handleClickTender:e=>{const{paidType:t=0}=e;if(L(),(null===f||void 0===f?void 0:f.length)<0)return s.a.warning({message:"Perhatian!",description:"Anda tidak dapat melakukan pembayaran jika tidak ada item yang dibeli."});if((null===D||void 0===D?void 0:D.cashPaid)>0){if(A((t=>({...t,tender:e}))),1===+t)return void I(e);if(2===+t)return void A((e=>({...e,modalCard:!0})));if(+t>=6&&+t<8)return void s.a.warning({message:"Perhatian!!!",description:"Fitur ini sedang dalam tahap pengembangan. Terima kasih"})}else L(),s.a.error({message:"Perhatian!",description:"Nominal pembayaran tidak boleh kosong!"})},handleFocus:L})}),Object(p.jsx)("div",{className:"w-full h-full overflow-scroll",children:Object(p.jsx)(y,{state:D,setState:A,handleFocus:L})})]})}),Object(p.jsx)("div",{className:"col-span-3 row-span-4 bg-white border-2 border-gray-400 rounded-md overflow-scroll px-5 py-2",children:Object(p.jsx)(O,{state:D})})]}),Object(p.jsx)(g,{state:D,setState:A,handlePaymentList:I,handleFocus:L}),Object(p.jsx)(v,{printRef:r,handlePaymentStore:()=>M(),open:null===D||void 0===D?void 0:D.modalCashChange,state:D,setState:A})]})}}}]);
//# sourceMappingURL=20.4c257592.chunk.js.map