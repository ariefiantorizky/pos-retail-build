{"version":3,"sources":["pages/POS/PrintPage.js","pages/POS/hooks/usePayment.js","pages/POS/components/ModalCashChange.js","pages/POS/payment/widget/DetailBill.js","pages/POS/payment/widget/ModalCard.js","pages/POS/payment/widget/ModalCash.js","pages/POS/payment/widget/TableBalanceOrder.js","pages/POS/payment/widget/TenderMedia.js","pages/POS/payment/index.js"],"names":["PrintPage","React","forwardRef","props","ref","transactions","cash","billDate","billNo","paymentMethod","isReprintBill","payments","isPrintTest","isPendingBill","property","setProperty","useState","billNoTrx","useSelector","state","transaction","loading","auth","useEffect","app","JSON","parse","localStorage","getItem","user","cashier","username","total","reduce","acc","cashPaid","paidValue","cashPay","paidType","cashChange","className","style","maxWidth","header1","header2","header3","header4","header5","header6","span","moment","format","length","map","i","ItemName","qty","price","wrap","gutter","currencyFormat","toString","trim","toUpperCase","index","tenderName","footer1","footer2","footer3","footer4","footer5","footer6","usePayment","dispatch","useDispatch","history","useHistory","data","getSubtotal","getDiscountTotal","getGrandTotal","getCashPaid","settles","cur","amountPaid","getCashChange","grandTotal","totalCashPay","getTotalQty","getBalanceDue","paymentStore","handlePrint","payload","header","custCode","custName","discPrc","discValue","taxPrc","taxValue","subTotal","shiftID","shiftId","outletCode","settle","amount","details","el","ItemNo","type","bill","from","to","ModalCashChange","handleCancel","open","modalRef","useRef","handleFocus","current","focus","handleEnterPress","e","key","preventDefault","modal","addEventListener","removeEventListener","modalCashChange","centered","closable","closeIcon","width","footer","bodyStyle","backgroundColor","autoFocus","tabIndex","onKeyDown","disabled","onClick","DetailBill","height","ModalCard","setState","handlePaymentList","form","useForm","modalCardRef","cardNameRef","cardNumberRef","prevState","modalCard","modalCash","resetFields","blur","onKeyDownGlobal","handleFocusCardName","document","activeElement","input","onCancel","layout","onFinish","tender","name","Item","label","rules","required","message","placeholder","value","card","onChange","event","target","no","htmlType","ModalCash","handleState","handleKeyDown","includes","handleFocusSelect","handleOk","notification","error","description","select","handleWheel","ctrlKey","deltaY","console","log","element","capture","passive","onOk","min","formatter","replace","parser","onPressEnter","onFocus","onWheel","TableBalanceOrder","activeIndex","setActiveIndex","tableRef","tableData","handleKeyDownGlobal","prevIndex","Math","max","settleCode","handleDeleteBalance","table","settleList","filter","item","border","icon","shape","danger","TenderMedia","handleClickTender","tenderMedia","buttonRefs","openPage","push","newIndex","numCols","scrollIntoView","behavior","block","tenderDiv","id","filteredTender","disabledButton","PaymentPage","componentPrintRef","subtotal","addPaymentList","cardName","cardHolder","cardNo","useReactToPrint","content","onBeforePrint","actions","SET_STATE","onPrintError","location","onAfterPrint","success","CLEAR_TRANSACTION_STORE","handlePaymentStore","contentStatus","prev","isPrintBill","isOpening","handlePayment","Date","warning"],"mappings":"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","file":"static/js/26.b0bd8003.chunk.js","sourcesContent":["/* eslint-disable no-unused-vars */\nimport { Col, Row } from 'antd';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { currencyFormat } from '../../utils/helper/utilities';\n\nexport const PrintPage = React.forwardRef((props, ref) => {\n\tconst {\n\t\ttransactions = [],\n\t\tcash = {},\n\t\tbillDate = '',\n\t\tbillNo = null,\n\t\tpaymentMethod = '',\n\t\tisReprintBill = false,\n\t\tpayments = [],\n\t\tisPrintTest = false,\n\t\tisPendingBill = false\n\t} = props;\n\n\tconst [property, setProperty] = useState({});\n\tconst { billNo: billNoTrx } = useSelector((state) => state?.transaction);\n\tconst { loading = false } = useSelector((state) => state?.auth);\n\n\tuseEffect(() => {\n\t\tconst app = JSON.parse(localStorage.getItem('app') || '{}');\n\t\tconst { property = {}, user = {} } = app;\n\n\t\tsetProperty({ ...property, cashier: user?.username || '' } || {});\n\t}, [ref]);\n\n\tconst total = transactions?.reduce((acc, { total = 0 }) => +acc + +total, 0);\n\tconst cashPaid = payments?.reduce((acc, { paidValue = 0, cashPay = 0, paidType }) => +acc + +(+paidType === 1 ? cashPay : paidValue), 0);\n\tconst cashChange = cashPaid - total;\n\n\treturn (\n\t\t<div className=\"w-full h-full rounded-md mx-auto\">\n\t\t\t<div className=\"w-full h-auto bg-white p-3 py-7 mx-auto rounded-md\" style={{ maxWidth: '305px' }} ref={ref}>\n\t\t\t\t{/* HEADER */}\n\t\t\t\t{loading ? (\n\t\t\t\t\t<p className=\"text-left text-print-xsmall text-gray-500\">Memuat data...</p>\n\t\t\t\t) : (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<p className=\"text-center text-print-medium font-bold\">{property?.header1 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-small font-semibold\">{property?.header2 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall mt-2\">{property?.header3 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{property?.header4 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{property?.header5 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{property?.header6 || ''}</p>\n\t\t\t\t\t\t<div className=\"my-3 w-full border border-separate border-gray-400\" />\n\t\t\t\t\t\t{isReprintBill && <p className=\"text-center text-print-small mt-3 font-semibold\">THIS IS COPY / REPRINT</p>}\n\t\t\t\t\t\t{isPrintTest && <p className=\"text-center text-print-small mt-3 font-semibold\">THIS IS PRINT TEST</p>}\n\t\t\t\t\t\t{isPendingBill && <p className=\"text-center text-print-small mt-3 font-semibold\">THIS IS PENDING BILL</p>}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t{isPrintTest || isReprintBill || isPendingBill ? <div className=\"my-3 w-full border border-separate border-gray-400\" /> : null}\n\n\t\t\t\t<Row>\n\t\t\t\t\t<Col span={7}>\n\t\t\t\t\t\t<p className=\"text-left text-print-xsmall\">Tanggal/Waktu</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={2}>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">:</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={15}>\n\t\t\t\t\t\t<p className=\"text-left text-print-xsmall\">{moment(billDate).format('ddd, DD MMMM YYYY LTS')}</p>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row className=\"my-1\">\n\t\t\t\t\t<Col span={7}>\n\t\t\t\t\t\t<p className=\"text-left text-print-xsmall\">No. Transaksi</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={2}>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">:</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={15}>\n\t\t\t\t\t\t<p className=\"text-left text-print-xsmall\">{billNo || billNoTrx || '-'}</p>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col span={7}>\n\t\t\t\t\t\t<p className=\"text-left text-print-xsmall\">Kasir</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={2}>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">:</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={15}>\n\t\t\t\t\t\t<p className=\"text-left text-print-xsmall\">{property?.cashier || ''}</p>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\n\t\t\t\t<div className=\"my-3 w-full border border-separate border-gray-400\" />\n\n\t\t\t\t{/* BODY / TRANSACTION */}\n\t\t\t\t{transactions?.length === 0 && <p className=\"text-left text-print-xsmall text-gray-500\">Tidak ada transaksi</p>}\n\t\t\t\t{transactions?.map(({ ItemName = '', qty = 0, price = 0, total = 0 }, i) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Row wrap gutter={[2, 2]} key={i} className=\"mb-2\">\n\t\t\t\t\t\t\t<Col span={24}>\n\t\t\t\t\t\t\t\t<p className=\"text-left text-print-xsmall\">{ItemName || ''}</p>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t<Col span={8}>\n\t\t\t\t\t\t\t\t<p className=\"text-left text-print-xsmall\">Rp {currencyFormat(price || 0, 0) || ''}</p>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t<Col span={8}>\n\t\t\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{qty || ''}x</p>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t<Col span={8}>\n\t\t\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Rp {currencyFormat((total || 0).toString(), 0) || '0'}</p>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t);\n\t\t\t\t})}\n\n\t\t\t\t<div className=\"my-3 w-full border border-separate border-gray-400\" />\n\n\t\t\t\t{/* PAYMENT */}\n\t\t\t\t{payments?.length === 0 ? (\n\t\t\t\t\t<Row className=\"my-1\">\n\t\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Pembayaran</p>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t\t<p className=\"text-right text-print-xsmall uppercase\">{(paymentMethod || '-').trim().toUpperCase()}</p>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t) : (\n\t\t\t\t\tpayments?.map(({ cashPay, tenderName, paidType, paidValue }, index) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Row className=\"my-1\">\n\t\t\t\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t\t\t\t<p className=\"text-right text-print-xsmall capitalize\">{(tenderName || '')?.trim()}</p>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t\t\t\t<p className=\"text-right text-print-xsmall uppercase\">\n\t\t\t\t\t\t\t\t\t\tRp {(currencyFormat(+paidType === 1 ? cashPay : paidValue, 0) || '')?.trim()}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\t\t\t\t)}\n\t\t\t\t<Row className=\"my-1\">\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Subtotal</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Rp {currencyFormat(total || '0', 0)}</p>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row className=\"my-1\">\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Diskon</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Rp 0</p>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row className=\"my-1\">\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Total</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Rp {currencyFormat(total || '0', 0)}</p>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row className=\"my-1\">\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Bayar</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Rp {currencyFormat(cashPaid || '0', 0)}</p>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row className=\"my-1\">\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Kembalian</p>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<p className=\"text-right text-print-xsmall\">Rp {cashChange <= 0 ? 0 : currencyFormat(cashChange || '0', 0)}</p>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\n\t\t\t\t{/* FOOTER */}\n\t\t\t\t{loading ? (\n\t\t\t\t\t<p className=\"text-left text-print-xsmall text-gray-500\">Memuat data...</p>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"mt-7\">\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall font-semibold\">{property?.footer1 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{property?.footer2 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{property?.footer3 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{property?.footer4 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{property?.footer5 || ''}</p>\n\t\t\t\t\t\t<p className=\"text-center text-print-xsmall\">{property?.footer6 || ''}</p>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n});\n","import { useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\n\nexport default function usePayment() {\n\tconst dispatch = useDispatch();\n\tconst history = useHistory();\n\n\tconst { billNo = '', billDate = '', data = [] } = useSelector((state) => state?.transaction);\n\tconst { cashier = {}, property = {} } = JSON.parse(localStorage.getItem('app') || '{}');\n\n\tconst getTotalQty = () => data?.reduce((acc, { qty = 0 }) => +acc + +qty, 0) || 0;\n\n\tconst getSubtotal = () => data?.reduce((acc, { total = 0 }) => +acc + +total, 0) || 0;\n\n\tconst getDiscountTotal = () => 0;\n\n\tconst getGrandTotal = () => {\n\t\treturn getSubtotal() - getDiscountTotal();\n\t};\n\n\tconst getCashPaid = (settles = []) => {\n\t\tconst totalCashPay =\n\t\t\tsettles?.length !== 0\n\t\t\t\t? settles.reduce((acc, cur) => {\n\t\t\t\t\t\treturn +acc + +cur.amountPaid;\n\t\t\t\t  }, 0)\n\t\t\t\t: 0;\n\n\t\treturn totalCashPay;\n\t};\n\n\tconst getCashChange = (settles = [], cashPaid = 0) => {\n\t\tconst grandTotal = getGrandTotal();\n\t\tconst totalCashPay = getCashPaid(settles);\n\n\t\tif (grandTotal === 0) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (cashPaid > grandTotal) {\n\t\t\treturn cashPaid - grandTotal;\n\t\t}\n\n\t\tif (totalCashPay > grandTotal) {\n\t\t\treturn totalCashPay - grandTotal;\n\t\t}\n\n\t\treturn 0;\n\t};\n\n\tconst getBalanceDue = (settles = [], cashPaid = 0) => {\n\t\tconst cashChange = getCashChange(settles, cashPaid);\n\t\tconst totalCashPay = getCashPaid(settles);\n\t\tconst grandTotal = getGrandTotal();\n\n\t\tif (totalCashPay >= grandTotal) {\n\t\t\treturn totalCashPay - grandTotal - cashChange;\n\t\t}\n\n\t\treturn getGrandTotal() - +totalCashPay;\n\t};\n\n\tconst paymentStore = (state, handlePrint) => {\n\t\tconst header = {\n\t\t\tbillNo,\n\t\t\tbillDate,\n\t\t\tcustCode: '',\n\t\t\tcustName: '',\n\t\t\tdiscPrc: '0',\n\t\t\tdiscValue: '0',\n\t\t\ttaxPrc: '0',\n\t\t\ttaxValue: '0',\n\t\t\tsubTotal: getSubtotal(),\n\t\t\tgrandTotal: getGrandTotal(),\n\t\t\tshiftID: cashier?.shiftId || '0',\n\t\t\toutletCode: property?.outletCode\n\t\t};\n\n\t\tconst settle =\n\t\t\tstate.settles?.length !== 0 &&\n\t\t\tstate.settles?.map((settle) => {\n\t\t\t\tconst cashPaid = settle.cashPay;\n\t\t\t\tconst cashChange = getCashChange(state?.settles, settle?.cashPay);\n\t\t\t\tconst paidType = +settle?.paidType;\n\n\t\t\t\treturn {\n\t\t\t\t\t...settle,\n\t\t\t\t\tcashChange: paidType === 1 ? cashChange : 0,\n\t\t\t\t\tamount: paidType === 1 ? cashPaid - cashChange : settle?.amount,\n\t\t\t\t\tamountPaid: paidType === 1 ? cashPaid - cashChange : settle?.amountPaid\n\t\t\t\t};\n\t\t\t});\n\n\t\tconst payload = {\n\t\t\theader: [header],\n\t\t\tsettle,\n\t\t\tdetails: data?.map((el, i) => ({ ...el, billNo, ItemNo: i + 1 }))\n\t\t};\n\n\t\tdispatch({\n\t\t\ttype: 'transaction/STORE',\n\t\t\tpayload,\n\t\t\tbill: {\n\t\t\t\tfrom: billDate,\n\t\t\t\tto: billDate\n\t\t\t},\n\t\t\thandlePrint: () => {\n\t\t\t\tif (typeof handlePrint === 'function') {\n\t\t\t\t\treturn handlePrint();\n\t\t\t\t}\n\t\t\t},\n\t\t\thistory\n\t\t});\n\t};\n\n\treturn { getTotalQty, getDiscountTotal, getSubtotal, getGrandTotal, getCashPaid, getCashChange, getBalanceDue, paymentStore };\n}\n","import { Button, Modal } from 'antd';\nimport React, { useEffect, useRef } from 'react';\nimport { ImSpinner2 } from 'react-icons/im';\nimport { useSelector } from 'react-redux';\nimport { currencyFormat } from '../../../utils/helper/utilities';\nimport usePayment from '../hooks/usePayment';\n\nexport default function ModalCashChange({ state = {}, handlePrint = null, handleCancel = () => {}, open = false }) {\n\tconst modalRef = useRef(null);\n\n\tconst { getCashChange } = usePayment();\n\tconst { loading = false } = useSelector((state) => state?.transaction);\n\n\tconst handleFocus = () => {\n\t\tconst modal = modalRef && modalRef.current !== null && modalRef.current;\n\n\t\tif (modal) {\n\t\t\tmodalRef.current.focus();\n\t\t}\n\t};\n\n\tconst handleEnterPress = (e) => {\n\t\tif (e.key === 'Enter') {\n\t\t\te.preventDefault();\n\t\t\thandlePrint();\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tconst modal = modalRef && modalRef.current !== null && modalRef.current;\n\n\t\thandleFocus();\n\n\t\tif (modal) {\n\t\t\thandleFocus();\n\t\t\tmodal.addEventListener('keydown', handleEnterPress);\n\n\t\t\treturn () => {\n\t\t\t\tmodal.removeEventListener('keydown', handleEnterPress);\n\t\t\t};\n\t\t}\n\t}, [modalRef]);\n\n\tuseEffect(() => {\n\t\thandleFocus();\n\t}, [open]);\n\n\tuseEffect(() => {\n\t\thandleFocus();\n\t\thandleFocus();\n\t\thandleFocus();\n\t}, [state?.modalCashChange, loading]);\n\n\thandleFocus();\n\n\treturn (\n\t\t<Modal centered closable={false} closeIcon={null} width={475} footer={false} open={open} bodyStyle={{ backgroundColor: '#f8f8f8' }}>\n\t\t\t<div\n\t\t\t\tautoFocus\n\t\t\t\ttabIndex={1}\n\t\t\t\tref={modalRef}\n\t\t\t\tonKeyDown={handleEnterPress}\n\t\t\t\tclassName=\"w-full h-60 flex items-center justify-center flex-col gap-3\">\n\t\t\t\t<h1 className=\"text-lg font-medium text-gray-700\">KEMBALIAN PELANGGAN</h1>\n\t\t\t\t<p className=\"text-3xl font-bold\">Rp {currencyFormat(getCashChange(state?.settles, state?.cashPaid), 0)}</p>\n\n\t\t\t\t{loading ? (\n\t\t\t\t\t<ImSpinner2 className=\"text-center text-3xl my-5 animate-spin\" />\n\t\t\t\t) : (\n\t\t\t\t\t<Button autoFocus disabled={loading} loading={loading} className=\"w-1/2 btn-page h-14 mt-7\" onClick={handlePrint}>\n\t\t\t\t\t\tPRINT BILL\n\t\t\t\t\t</Button>\n\t\t\t\t)}\n\n\t\t\t\t<p className=\"text-center text-base\">\n\t\t\t\t\tUntuk melakukan cetak struk, anda dapat <b>KLIK</b> tombol diatas, ataupun tekan <b>ENTER</b>\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</Modal>\n\t);\n}\n","import React from 'react';\nimport { currencyFormat } from '../../../../utils/helper/utilities';\nimport usePayment from '../../hooks/usePayment';\n\nexport default function DetailBill({ state }) {\n\tconst { getSubtotal, getDiscountTotal } = usePayment();\n\n\treturn (\n\t\t<div className=\"w-full h-full\">\n\t\t\t<h1 className=\"text-base font-semibold\">Detail Transaksi</h1>\n\t\t\t<div className=\"w-full bg-gray-400 mt-2 mb-2\" style={{ height: '1.5px' }} />\n\t\t\t<table className=\"w-full\">\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr className=\"w-full h-6\">\n\t\t\t\t\t\t<td className=\"w-1/2 text-sm uppercase font-semibold text-gray-800\">Subtotal</td>\n\t\t\t\t\t\t<td className=\"text-sm uppercase font-medium text-gray-800\">:</td>\n\t\t\t\t\t\t<td className=\"w-1/2 pl-2 text-sm uppercase font-medium text-gray-800\">idr {currencyFormat(getSubtotal(), 0)}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr className=\"w-full h-6\">\n\t\t\t\t\t\t<td className=\"w-1/2 text-sm uppercase font-semibold text-gray-800\">Diskon</td>\n\t\t\t\t\t\t<td className=\"text-sm uppercase font-medium text-gray-800\">:</td>\n\t\t\t\t\t\t<td className=\"w-1/2 pl-2 text-sm uppercase font-medium text-gray-800\">idr {currencyFormat(getDiscountTotal(), 0)}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr className=\"w-full h-6\">\n\t\t\t\t\t\t<td className=\"w-1/2 text-sm uppercase font-semibold text-gray-800\">PPN 11%</td>\n\t\t\t\t\t\t<td className=\"text-sm uppercase font-medium text-gray-800\">:</td>\n\t\t\t\t\t\t<td className=\"w-1/2 pl-2 text-sm uppercase font-medium text-gray-800\">idr 0</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div>\n\t);\n}\n","import { Button, Form, Input, Modal } from 'antd';\nimport React, { useEffect, useRef } from 'react';\n\nexport default function ModalCard({ state, setState, handlePaymentList }) {\n\tconst [form] = Form.useForm();\n\n\tconst modalCardRef = useRef(null);\n\tconst cardNameRef = useRef(null);\n\tconst cardNumberRef = useRef(null);\n\n\tconst handleCancel = () => {\n\t\tsetState((prevState) => ({\n\t\t\t...prevState,\n\t\t\tmodalCard: false,\n\t\t\tmodalCash: false\n\t\t}));\n\n\t\tform.resetFields();\n\t\tcardNameRef && cardNameRef.current.blur();\n\t\tcardNumberRef && cardNumberRef.current.blur();\n\t};\n\n\tconst onFinish = () => {\n\t\thandlePaymentList(state?.tender);\n\t\thandleCancel();\n\t};\n\n\tconst onKeyDownGlobal = (e) => {\n\t\tif (e.key === 'ArrowUp') {\n\t\t\thandleFocusCardName();\n\t\t}\n\n\t\tif (e.key === 'ArrowDown' && cardNameRef.current && document.activeElement === cardNameRef.current.input) {\n\t\t\tcardNameRef && cardNameRef.current.blur();\n\t\t\tcardNumberRef && cardNumberRef.current.focus();\n\t\t}\n\n\t\tif (e.key === 'Enter' && cardNameRef.current && document.activeElement === cardNameRef.current.input) {\n\t\t\tcardNameRef && cardNameRef.current.blur();\n\t\t\tcardNumberRef && cardNumberRef.current.focus();\n\t\t}\n\t};\n\n\tconst handleFocusCardName = () => {\n\t\treturn cardNameRef && cardNameRef.current && cardNameRef.current.focus();\n\t};\n\n\tuseEffect(() => {\n\t\thandleFocusCardName();\n\n\t\tdocument.addEventListener('keydown', onKeyDownGlobal);\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', onKeyDownGlobal);\n\t\t};\n\t}, [state?.modalCard]);\n\n\tuseEffect(() => {\n\t\thandleFocusCardName();\n\t}, [cardNameRef]);\n\treturn (\n\t\t<Modal open={state?.modalCard} onCancel={handleCancel} centered width={650} footer={null}>\n\t\t\t<div ref={modalCardRef} className=\"w-full h-full\">\n\t\t\t\t<h1 className=\"text-lg font-semibold mb-5\">MASUKKAN KARTU</h1>\n\n\t\t\t\t<Form layout=\"vertical\" onFinish={onFinish} form={form} name=\"card-form\">\n\t\t\t\t\t<Form.Item\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tname=\"cardName\"\n\t\t\t\t\t\tlabel={<p>Nama Kartu / Pemilik</p>}\n\t\t\t\t\t\trules={[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t\tmessage: 'Wajib Diisi!'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]}>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tautoFocus={true}\n\t\t\t\t\t\t\tref={cardNameRef}\n\t\t\t\t\t\t\tplaceholder=\"John Doe\"\n\t\t\t\t\t\t\tvalue={state?.card?.name}\n\t\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\t\tconst value = event.target.value;\n\n\t\t\t\t\t\t\t\tsetState((prevState) => ({\n\t\t\t\t\t\t\t\t\t...prevState,\n\t\t\t\t\t\t\t\t\tcard: {\n\t\t\t\t\t\t\t\t\t\t...prevState.card,\n\t\t\t\t\t\t\t\t\t\tname: value\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName=\"w-full h-14 rounded-md\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Form.Item>\n\t\t\t\t\t<Form.Item\n\t\t\t\t\t\tname=\"cardNo\"\n\t\t\t\t\t\tlabel={<p>Nomor Kartu</p>}\n\t\t\t\t\t\trules={[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t\tmessage: 'Wajib Diisi!'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]}>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tref={cardNumberRef}\n\t\t\t\t\t\t\tplaceholder=\"0001881923\"\n\t\t\t\t\t\t\tvalue={state?.card?.no}\n\t\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\t\tconst value = event.target.value;\n\n\t\t\t\t\t\t\t\tsetState((prevState) => ({\n\t\t\t\t\t\t\t\t\t...prevState,\n\t\t\t\t\t\t\t\t\tcard: {\n\t\t\t\t\t\t\t\t\t\t...prevState.card,\n\t\t\t\t\t\t\t\t\t\tno: value\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName=\"w-full h-14 rounded-md\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Form.Item>\n\t\t\t\t\t<div className=\"w-full h-auto p-3 bg-gray-100 rounded-md mb-5\">\n\t\t\t\t\t\tGunakan <b>&uarr;</b> untuk mengisi <b>Nama Kartu</b>, dan <b>&darr;</b> mengisi <b>Nomor Kartu</b>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Form.Item>\n\t\t\t\t\t\t<div className=\"w-full flex items-center justify-end gap-3\">\n\t\t\t\t\t\t\t<Button htmlType=\"button\" className=\"h-14 px-5 rounded-md uppercase\" onClick={handleCancel}>\n\t\t\t\t\t\t\t\tBatalkan\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button htmlType=\"submit\" className=\"btn-page h-12 w-max px-7\">\n\t\t\t\t\t\t\t\tBayar\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Form.Item>\n\t\t\t\t</Form>\n\t\t\t</div>\n\t\t</Modal>\n\t);\n}\n","import { InputNumber, Modal, notification } from 'antd';\nimport React, { useEffect, useRef } from 'react';\nimport { useSelector } from 'react-redux';\n\nexport const ModalCash = ({ state, handleState, handleCancel, handlePaymentList }) => {\n\tconst ref = useRef(null);\n\n\tconst { data: transaction = [] } = useSelector((state) => state?.transaction);\n\tconst { tender = {}, modalCash = false } = state;\n\n\tconst handleKeyDown = (e) => {\n\t\tconst allowedKeys = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0', 'Backspace', 'Delete', 'ArrowDown', 'ArrowUp', 'Enter'];\n\t\tconst key = e.key;\n\n\t\tif (allowedKeys.includes(key)) {\n\t\t\thandleFocus();\n\n\t\t\tif (key === 'ArrowUp' || key === 'ArrowDown') {\n\t\t\t\te.preventDefault();\n\t\t\t\thandleFocusSelect();\n\t\t\t}\n\t\t}\n\t};\n\n\tconst handleOk = (e) => {\n\t\tif (transaction.length === 0) {\n\t\t\treturn notification.error({\n\t\t\t\tmessage: 'Perhatian!',\n\t\t\t\tdescription: 'Tidak ada transaksi, silahkan lakukan transaksi terlebih dahulu.'\n\t\t\t});\n\t\t}\n\n\t\tif (+state?.cashPaid === 0 || +state?.cashPaid < 1) {\n\t\t\treturn notification.error({\n\t\t\t\tmessage: 'Perhatian!',\n\t\t\t\tdescription: 'Nominal pembayaran tidak boleh 0 atau minus'\n\t\t\t});\n\t\t}\n\n\t\tif (+tender?.paidType === 2) {\n\t\t\tref.current.blur();\n\t\t\te.target.blur();\n\n\t\t\thandleState('modalCash', false);\n\t\t\thandleState('modalCard', true);\n\n\t\t\treturn;\n\t\t} else {\n\t\t\thandlePaymentList(state?.tender);\n\t\t\thandleCancel();\n\t\t}\n\t};\n\n\tconst handleFocus = () => {\n\t\tif (ref && ref.current !== null) {\n\t\t\tref.current.focus();\n\t\t}\n\t};\n\n\tconst handleFocusSelect = () => {\n\t\tif (ref && ref.current !== null) {\n\t\t\tref.current.focus();\n\t\t\tref.current.select();\n\t\t}\n\t};\n\n\tconst handleWheel = (event) => {\n\t\tif (event.ctrlKey) {\n\t\t\tevent.preventDefault();\n\t\t\t//control key is pressed\n\t\t\tif (event.deltaY > 0) {\n\t\t\t\t//scrolled down\n\t\t\t\tconsole.log('Scroll Down');\n\t\t\t} else {\n\t\t\t\t//scrolled up\n\t\t\t\tconsole.log('Scrolled Up');\n\t\t\t}\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\thandleFocusSelect();\n\t\tdocument.addEventListener('keydown', handleKeyDown);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', handleKeyDown);\n\t\t};\n\t}, [modalCash]);\n\n\tuseEffect(() => {\n\t\thandleFocus();\n\t}, [modalCash, state]);\n\n\tuseEffect(() => {\n\t\tconst element = ref.current;\n\t\tif (element) {\n\t\t\telement.addEventListener('wheel', handleWheel, {\n\t\t\t\tcapture: true,\n\t\t\t\tpassive: false\n\t\t\t});\n\t\t}\n\n\t\treturn () => {\n\t\t\tif (element) {\n\t\t\t\telement.removeEventListener('wheel', handleWheel);\n\t\t\t}\n\t\t};\n\t}, [ref, modalCash]);\n\n\treturn (\n\t\t<Modal open={modalCash} onOk={handleOk} onCancel={handleCancel} centered width={650}>\n\t\t\t<h1 className=\"text-lg font-semibold text-center mb-5\">INPUT NOMINAL PEMBAYARAN</h1>\n\n\t\t\t<InputNumber\n\t\t\t\tmin={0}\n\t\t\t\tname=\"cashPaid\"\n\t\t\t\tref={ref}\n\t\t\t\tautoFocus={true}\n\t\t\t\tclassName=\"w-full h-32 p-5 flex items-center bg-transparent text-4xl text-black font-bold border-none\"\n\t\t\t\tplaceholder=\"MASUKKAN NOMINAL PEMBAYARAN\"\n\t\t\t\tvalue={state?.cashPaid}\n\t\t\t\tformatter={(value) => `IDR ${value}`.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')}\n\t\t\t\tparser={(value) => value?.replace(/IDR\\s?|(,*)/g, '')}\n\t\t\t\tonChange={(e) => {\n\t\t\t\t\thandleState('cashPaid', e);\n\t\t\t\t\thandleFocus();\n\t\t\t\t}}\n\t\t\t\tonPressEnter={(e) => {\n\t\t\t\t\thandleOk(e);\n\t\t\t\t}}\n\t\t\t\tonClick={() => {\n\t\t\t\t\thandleFocusSelect();\n\t\t\t\t}}\n\t\t\t\tonFocus={() => {\n\t\t\t\t\thandleFocus();\n\t\t\t\t}}\n\t\t\t\tonWheel={(event) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t<div className=\"w-full h-auto p-3 bg-gray-200 rounded-md my-4 mt-7\">\n\t\t\t\t<h1>\n\t\t\t\t\tGunakan <b>&uarr;</b> / <b>&darr;</b> untuk select dan menghapus angka pada input nominal, lalu Anda dapat <b>mengetikkan</b>{' '}\n\t\t\t\t\tlangsung <b>angka</b> nominal yang ingin di input. . Atau gunakan <b>Backspace</b> / <b>Delete</b> untuk menghapus nominal.\n\t\t\t\t</h1>\n\t\t\t</div>\n\t\t</Modal>\n\t);\n};\n","import { Button } from 'antd';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { FaRegTrashCan } from 'react-icons/fa6';\nimport { currencyFormat } from '../../../../utils/helper/utilities';\n\nexport default function TableBalanceOrder({ state, setState, handleFocus }) {\n\tconst [activeIndex, setActiveIndex] = useState(-1);\n\tconst tableRef = useRef(null);\n\tconst tableData = state?.settles || [];\n\n\tconst handleKeyDownGlobal = (e) => {\n\t\tswitch (e.key) {\n\t\t\tcase 'F4':\n\t\t\t\tsetActiveIndex(0);\n\n\t\t\t\te.target.blur();\n\t\t\t\te.preventDefault();\n\t\t\t\ttableRef && tableRef.current.focus();\n\t\t\t\tbreak;\n\t\t\tcase 'F3':\n\t\t\t\ttableRef && tableRef.current.blur();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\tconst handleKeyDown = (e) => {\n\t\tswitch (e.key) {\n\t\t\tcase 'ArrowUp':\n\t\t\t\tsetActiveIndex((prevIndex) => Math.max(prevIndex - 1, 0));\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowDown':\n\t\t\t\tsetActiveIndex((prevIndex) => Math.min(prevIndex + 1, tableData.length - 1));\n\t\t\t\tbreak;\n\t\t\tcase 'Enter':\n\t\t\t\tconst settleCode = tableData[activeIndex]?.settleCode;\n\t\t\t\tif (settleCode) {\n\t\t\t\t\thandleDeleteBalance(settleCode);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'Escape':\n\t\t\t\te.target.blur();\n\t\t\t\thandleFocus();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tif (tableRef.current) {\n\t\t\ttableRef.current.focus();\n\t\t}\n\n\t\tdocument.addEventListener('keydown', handleKeyDownGlobal);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', handleKeyDownGlobal);\n\t\t};\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst table = tableRef.current;\n\t\tif (table) {\n\t\t\ttable.addEventListener('keydown', handleKeyDown);\n\t\t\treturn () => {\n\t\t\t\ttable.removeEventListener('keydown', handleKeyDown);\n\t\t\t};\n\t\t}\n\t}, [tableData, activeIndex]);\n\n\tconst handleDeleteBalance = (settleCode) => {\n\t\tconst settleList = state?.settles;\n\t\tsetState({\n\t\t\tsettles: settleList?.filter((item) => item.settleCode !== settleCode)\n\t\t});\n\n\t\ttableRef.current.focus();\n\t\thandleFocus();\n\t};\n\n\treturn (\n\t\t<div className=\"w-full h-full relative\">\n\t\t\t<h1 className=\"mb-3 text-lg font-semibold\">\n\t\t\t\tAlokasi Pembayaran <kbd className=\"kbd\">F4</kbd>\n\t\t\t</h1>\n\t\t\t<table ref={tableRef} tabIndex={0} className=\"table-fixed w-full\" border>\n\t\t\t\t<thead className=\"w-full h-14 bg-primary sticky top-0\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th className=\"w-10 text-center\">#</th>\n\t\t\t\t\t\t<th className=\"w-1/2 text-left px-3 text-white\">Payment Type</th>\n\t\t\t\t\t\t<th className=\"w-1/2 text-right px-3 text-white\">Amount</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{tableData.map(({ cashPay = 0, tenderName = '', settleCode = '', amountPaid }, index) => (\n\t\t\t\t\t\t<tr key={settleCode} className={`w-full h-14 border border-gray-500 ${index === activeIndex ? 'bg-yellow-200' : ''}`}>\n\t\t\t\t\t\t\t<td className=\"w-10 text-center\">\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\ticon={<FaRegTrashCan className=\"text-white\" />}\n\t\t\t\t\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t\t\t\t\tclassName=\"flex items-center justify-center mx-auto\"\n\t\t\t\t\t\t\t\t\tshape=\"circle\"\n\t\t\t\t\t\t\t\t\tdanger\n\t\t\t\t\t\t\t\t\tonClick={() => handleDeleteBalance(settleCode)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td className=\"w-1/2 text-left px-3 text-black\">{tenderName.trim().toUpperCase()}</td>\n\t\t\t\t\t\t\t<td className=\"w-1/2 text-right px-3 text-black\">Rp {currencyFormat(amountPaid)}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t))}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div>\n\t);\n}\n","import { Button } from 'antd';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport usePayment from '../../hooks/usePayment';\n\nexport default function TenderMedia({ form, state, setState, handleClickTender, handleFocus }) {\n\tconst history = useHistory();\n\tconst { tenderMedia = [], data = [] } = useSelector((state) => state?.transaction);\n\tconst { getGrandTotal } = usePayment();\n\n\tconst ref = useRef();\n\tconst buttonRefs = useRef([]);\n\n\tconst [activeIndex, setActiveIndex] = useState(-1);\n\n\tconst openPage = () => history.push('/pos/kasir');\n\n\tconst onKeyDownGlobal = (e) => {\n\t\tconst key = e.key;\n\n\t\tif (key === 'F3') {\n\t\t\t// F3 key\n\t\t\te.preventDefault();\n\n\t\t\tsetActiveIndex(0);\n\t\t\tref && ref.current.focus();\n\t\t}\n\n\t\tif (key === 'F4') {\n\t\t\tsetActiveIndex(-1);\n\t\t\tref && ref.current.blur();\n\t\t}\n\n\t\tif (key === 'Escape') {\n\t\t\te.target.blur();\n\t\t\thandleFocus();\n\t\t}\n\n\t\tif (key === 'End') {\n\t\t\topenPage();\n\t\t}\n\t};\n\n\tconst onKeyDown = (e) => {\n\t\tconst key = e.key;\n\t\tconst allowedKeys = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Enter'];\n\n\t\tif (allowedKeys.includes(key)) {\n\t\t\te.preventDefault();\n\n\t\t\tlet newIndex = activeIndex;\n\t\t\tconst numCols = 3; // Number of columns in the grid\n\n\t\t\tif (key === 'ArrowLeft') {\n\t\t\t\t// Arrow Right\n\t\t\t\tif (activeIndex % numCols === 0) {\n\t\t\t\t\t// Stay on the same row if already on the leftmost column\n\t\t\t\t\tnewIndex = activeIndex + (numCols + 1);\n\t\t\t\t} else {\n\t\t\t\t\tnewIndex -= 1;\n\t\t\t\t}\n\t\t\t} else if (key === 'ArrowRight') {\n\t\t\t\t// Arrow Left\n\t\t\t\tif ((activeIndex + 1) % numCols === 0) {\n\t\t\t\t\t// Stay on the same row if already on the rightmost column\n\t\t\t\t\tnewIndex = activeIndex - (numCols - 1);\n\t\t\t\t} else {\n\t\t\t\t\tnewIndex += 1;\n\t\t\t\t}\n\t\t\t} else if (key === 'ArrowUp') {\n\t\t\t\t// Arrow Up\n\t\t\t\tif (activeIndex - numCols < 0) {\n\t\t\t\t\t// Stay on the same row if already on the topmost row\n\t\t\t\t\tnewIndex = (tenderMedia.length - numCols + (activeIndex % numCols)) % tenderMedia.length;\n\t\t\t\t} else {\n\t\t\t\t\tnewIndex -= 1;\n\t\t\t\t}\n\t\t\t} else if (key === 'ArrowDown') {\n\t\t\t\t// Arrow Down\n\t\t\t\tif (activeIndex + numCols >= tenderMedia.length) {\n\t\t\t\t\t// Stay on the same row if already on the bottommost row\n\t\t\t\t\tnewIndex = (tenderMedia.length - numCols + (activeIndex % numCols)) % tenderMedia.length;\n\t\t\t\t} else {\n\t\t\t\t\tnewIndex += 1;\n\t\t\t\t}\n\t\t\t} else if (key === 'Enter') {\n\t\t\t\t// Enter\n\t\t\t\tconst isDisabled = buttonRefs.current[newIndex] && buttonRefs.current[newIndex].disabled;\n\n\t\t\t\tif (!isDisabled) {\n\t\t\t\t\thandleClickTender(tenderMedia[activeIndex]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetActiveIndex(newIndex);\n\t\t\tbuttonRefs.current[newIndex] && buttonRefs.current[newIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tdocument.addEventListener('keydown', onKeyDownGlobal);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', onKeyDownGlobal);\n\t\t};\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (data.length === 0) {\n\t\t\topenPage();\n\t\t\treturn;\n\t\t}\n\t}, [data]);\n\n\tuseEffect(() => {\n\t\tconst tenderDiv = ref && ref.current !== null ? ref.current : null;\n\t\tif (tenderDiv) {\n\t\t\ttenderDiv.addEventListener('keydown', onKeyDown);\n\n\t\t\treturn () => {\n\t\t\t\ttenderDiv.removeEventListener('keydown', onKeyDown);\n\t\t\t};\n\t\t}\n\t}, [activeIndex, tenderMedia]);\n\n\treturn (\n\t\t<>\n\t\t\t<div ref={ref} tabIndex={-1} id=\"tender-media\" className=\"w-full h-full overflow-y-scroll overflow-x-hidden \">\n\t\t\t\t<h1 className=\"mb-3 text-lg font-semibold\">\n\t\t\t\t\tMetode Pembayaran <kbd className=\"kbd\">f3</kbd>\n\t\t\t\t</h1>\n\t\t\t\t<div className=\"w-full h-auto grid grid-cols-3 gap-3\">\n\t\t\t\t\t<Button className=\"col-span-3 btn-page bg-transparent border-2 border-red-500 text-red-600\" onClick={openPage}>\n\t\t\t\t\t\tbatalkan <kbd className=\"kbd\">end</kbd>\n\t\t\t\t\t</Button>\n\t\t\t\t\t{/* <Button className=\"col-span-2 btn-page\" onClick={handleCash}>\n\t\t\t\t\t\tuang pas <kbd className=\"kbd\">f1</kbd>\n\t\t\t\t\t</Button> */}\n\n\t\t\t\t\t{tenderMedia?.length !== 0 &&\n\t\t\t\t\t\ttenderMedia?.map((tender, index) => {\n\t\t\t\t\t\t\tconst { settleCode, tenderName } = tender;\n\n\t\t\t\t\t\t\tconst filteredTender =\n\t\t\t\t\t\t\t\tstate?.settles.length !== 0 ? state?.settles.filter((settle) => settle?.settleCode === settleCode) : [];\n\n\t\t\t\t\t\t\tconst isDisabled = filteredTender?.length !== 0 ? filteredTender[0].settleCode === settleCode : false;\n\t\t\t\t\t\t\tconst disabledButton = isDisabled || data?.length === 0 || getGrandTotal() === 0;\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tref={(el) => (buttonRefs.current[index] = el)}\n\t\t\t\t\t\t\t\t\tclassName={`btn-page ${index === activeIndex ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\tdisabled={disabledButton}\n\t\t\t\t\t\t\t\t\tkey={settleCode}\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tif (!disabledButton) {\n\t\t\t\t\t\t\t\t\t\t\thandleClickTender(tender);\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tonKeyDown={(e) => {\n\t\t\t\t\t\t\t\t\t\tif (e.key === 'Enter') {\n\t\t\t\t\t\t\t\t\t\t\tif (!disabledButton) {\n\t\t\t\t\t\t\t\t\t\t\t\thandleClickTender(tender);\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t{tenderName.trim().toUpperCase()}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { PrintPage } from '../PrintPage';\n\nimport { Form, notification } from 'antd';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom/cjs/react-router-dom.min';\nimport { useReactToPrint } from 'react-to-print';\nimport actions from '../../../redux/transaction/actions';\nimport { currencyFormat } from '../../../utils/helper/utilities';\nimport '../app.css';\nimport ModalCashChange from '../components/ModalCashChange';\nimport usePayment from '../hooks/usePayment';\nimport DetailBill from './widget/DetailBill';\nimport ModalCard from './widget/ModalCard';\nimport { ModalCash } from './widget/ModalCash';\nimport TableBalanceOrder from './widget/TableBalanceOrder';\nimport TenderMedia from './widget/TenderMedia';\n\nexport default function PaymentPage() {\n\tconst history = useHistory();\n\tconst dispatch = useDispatch();\n\n\tlet componentPrintRef = useRef(null);\n\n\tconst { billNo = '', data = [] } = useSelector((state) => state?.transaction);\n\tconst { getSubtotal, getGrandTotal, getCashPaid, getCashChange, getBalanceDue, paymentStore } = usePayment();\n\tconst { cashier = {} } = JSON.parse(localStorage.getItem('app') || '{}');\n\n\tconst [form] = Form.useForm();\n\tconst [state, setState] = useState({\n\t\tcashPaid: 0,\n\t\tcashChange: 0,\n\t\tcard: {\n\t\t\tname: '',\n\t\t\tno: ''\n\t\t},\n\t\tsettles: [],\n\t\tsubtotal: getSubtotal(),\n\t\tgrandTotal: getGrandTotal(),\n\t\tmodalCash: false,\n\t\tmodalCard: false,\n\t\tmodalCashChange: false,\n\t\ttender: {}\n\t});\n\n\tconst getTenderMedia = () => {\n\t\tdispatch({\n\t\t\ttype: 'transaction/TENDER_MEDIA'\n\t\t});\n\t};\n\n\tconst addPaymentList = (tender) => {\n\t\tconst { settleCode = '', tenderName = '', paidType = '' } = tender;\n\t\tconst settles = state?.settles || [];\n\t\tconst cashChange = getCashChange(settles, state?.cashPaid);\n\n\t\tconsole.log('STATE ===================> ', state);\n\n\t\tif (state?.cashPaid > 0) {\n\t\t\tconst settle = {\n\t\t\t\tbillNo,\n\t\t\t\tcustCode: '',\n\t\t\t\tcustName: '',\n\t\t\t\tpaidType,\n\t\t\t\tsettleCode,\n\t\t\t\tamount: state?.cashPaid || 0,\n\t\t\t\tamountPaid: state?.cashPaid || 0,\n\t\t\t\tpaidValue: state?.cashPaid || 0,\n\t\t\t\tcashPay: +paidType === 2 ? 0 : state?.cashPaid || 0,\n\t\t\t\tcashChange: +paidType === 2 ? 0 : cashChange || 0,\n\t\t\t\ttenderName,\n\t\t\t\tcardName: +paidType === 2 ? state?.card.name || '' : '',\n\t\t\t\tcardHolder: +paidType === 2 ? state?.card.name || '' : '',\n\t\t\t\tcardNo: +paidType === 2 ? state?.card.no || '0' : ''\n\t\t\t};\n\n\t\t\tsetState((prevState) => ({\n\t\t\t\t...prevState,\n\t\t\t\tsettles: [...prevState.settles, settle],\n\t\t\t\tcashPaid: 0\n\t\t\t}));\n\n\t\t\tform.resetFields();\n\t\t\treturn;\n\t\t}\n\n\t\tnotification.error({\n\t\t\tmessage: 'Gagal!',\n\t\t\tdescription: 'Nominal yang anda masukkan tidak boleh 0.'\n\t\t});\n\t};\n\n\tconst handleClickTender = (tender) => {\n\t\tconst { paidType = 0 } = tender;\n\n\t\tif (data?.length < 0) {\n\t\t\treturn notification.warning({\n\t\t\t\tmessage: 'Perhatian!',\n\t\t\t\tdescription: 'Anda tidak dapat melakukan pembayaran jika tidak ada item yang dibeli.'\n\t\t\t});\n\t\t}\n\n\t\tsetState((prev) => ({\n\t\t\t...prev,\n\t\t\ttender\n\t\t}));\n\n\t\tif (+paidType === 1) {\n\t\t\tsetState((prevState) => ({\n\t\t\t\t...prevState,\n\t\t\t\tmodalCash: true\n\t\t\t}));\n\t\t\treturn;\n\t\t}\n\n\t\tif (+paidType === 2) {\n\t\t\tsetState((prevState) => ({\n\t\t\t\t...prevState,\n\t\t\t\tmodalCash: true,\n\t\t\t\tcashPaid: getBalanceDue(state?.settles, state?.cashPaid)\n\t\t\t}));\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (+paidType >= 6 && +paidType < 8) {\n\t\t\tnotification.warning({\n\t\t\t\tmessage: 'Perhatian!!!',\n\t\t\t\tdescription: 'Fitur ini sedang dalam tahap pengembangan. Terima kasih'\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\t};\n\n\tconst handlePrint = useReactToPrint({\n\t\tcontent: () => componentPrintRef.current,\n\t\tonBeforePrint: () => {\n\t\t\tdispatch({\n\t\t\t\ttype: actions.SET_STATE,\n\t\t\t\tpayload: {\n\t\t\t\t\tloading: true\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tonPrintError: (location, error) => {\n\t\t\tconsole.log('Error Print!', error);\n\n\t\t\tnotification.error({\n\t\t\t\tmessage: 'Print Struk!',\n\t\t\t\tdescription: `Gagal mencetak struk. ${location} - ${error}`\n\t\t\t});\n\n\t\t\tdispatch({\n\t\t\t\ttype: actions.SET_STATE,\n\t\t\t\tpayload: {\n\t\t\t\t\tloading: false\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tonAfterPrint: () => {\n\t\t\tnotification.success({\n\t\t\t\tmessage: 'Print!',\n\t\t\t\tdescription: 'Cetak struk berhasil.'\n\t\t\t});\n\n\t\t\tdispatch({\n\t\t\t\ttype: actions.CLEAR_TRANSACTION_STORE,\n\t\t\t\thistory\n\t\t\t});\n\t\t}\n\t});\n\n\tconst handlePaymentStore = () => {\n\t\treturn paymentStore(\n\t\t\tstate,\n\t\t\thandlePrint(null, () => componentPrintRef)\n\t\t);\n\t};\n\n\tconst handlePayment = () => {\n\t\tconst settles = state?.settles || [];\n\t\tconst cashChange = getCashChange(settles, state?.cashPaid);\n\t\tconst cashPaid = getCashPaid(settles);\n\t\tconst grandTotal = getGrandTotal();\n\n\t\tif (cashPaid > grandTotal && cashChange > 0) {\n\t\t\tpaymentStore(state, null);\n\t\t\tsetState((prev) => ({\n\t\t\t\t...prev,\n\t\t\t\tmodalCashChange: true\n\t\t\t}));\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (cashPaid === grandTotal) {\n\t\t\thandlePaymentStore();\n\t\t\treturn;\n\t\t}\n\t};\n\n\tconst handleState = (state, value) => {\n\t\tsetState((prev) => ({\n\t\t\t...prev,\n\t\t\t[state]: value\n\t\t}));\n\t};\n\n\tconst handleCancel = () => {\n\t\tdispatch({\n\t\t\ttype: 'transaction/SET_STATE',\n\t\t\tpayload: {\n\t\t\t\tcontentStatus: 'isMenu'\n\t\t\t}\n\t\t});\n\n\t\tsetState((prev) => ({\n\t\t\t...prev,\n\t\t\tmodalCash: false,\n\t\t\tmodalCard: false,\n\t\t\tmodalCashChange: false\n\t\t}));\n\t};\n\n\tuseEffect(() => {\n\t\tgetTenderMedia();\n\n\t\tdispatch({\n\t\t\ttype: actions.SET_STATE,\n\t\t\tpayload: {\n\t\t\t\tisPrintBill: false\n\t\t\t}\n\t\t});\n\n\t\tif (!cashier?.isOpening) {\n\t\t\thistory.push('/pos');\n\n\t\t\tnotification.error({\n\t\t\t\tmessage: 'Error!',\n\t\t\t\tdescription: 'Mohon untuk melakukan Buka Kasir terlebih dahulu sebelum melanjutkan transaksi.'\n\t\t\t});\n\t\t}\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (data?.length !== 0 && state?.settles.length !== 0) {\n\t\t\thandlePayment();\n\t\t}\n\t}, [state?.settles]);\n\n\treturn (\n\t\t<div className=\"w-screen h-screen overflow-x-hidden overflow-y-scroll\">\n\t\t\t<div className=\"w-full h-full grid grid-cols-12 grid-rows-6 gap-3 p-3\">\n\t\t\t\t<div className=\"col-span-3 row-span-5 bg-white overflow-scroll p-3 rounded-md border-2 border-gray-400\">\n\t\t\t\t\t<div className=\"w-full h-full\">\n\t\t\t\t\t\t<PrintPage\n\t\t\t\t\t\t\tref={(el) => (componentPrintRef = el)}\n\t\t\t\t\t\t\ttransactions={data}\n\t\t\t\t\t\t\tcash={{\n\t\t\t\t\t\t\t\tcashChange: getCashChange(state?.settles, state?.cashPaid),\n\t\t\t\t\t\t\t\tcashPaid: getCashPaid(state?.settles),\n\t\t\t\t\t\t\t\ttotal: state?.grandTotal\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tbillDate={new Date()}\n\t\t\t\t\t\t\tpayments={state?.settles}\n\t\t\t\t\t\t\tpaymentMethod={state?.settles[0]?.tenderName}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-span-9 row-span-1 bg-primary rounded-md\">\n\t\t\t\t\t<div className=\"w-full h-full p-5 flex flex-row items-center justify-between gap-3\">\n\t\t\t\t\t\t<h1 className=\"text-lg text-white\">Total Belanja</h1>\n\t\t\t\t\t\t<h1 className=\"text-4xl text-white font-semibold capitalize\">Rp {currencyFormat(getGrandTotal(), 0)}</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t.\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-span-9 row-span-1\">\n\t\t\t\t\t<div className=\"w-full h-full flex items-center gap-3\">\n\t\t\t\t\t\t<div className=\"w-full h-full bg-white rounded-md p-3 flex flex-col items-center justify-center\">\n\t\t\t\t\t\t\t<h1>Kembalian</h1>\n\t\t\t\t\t\t\t<h1 className=\"text-2xl font-semibold capitalize\">\n\t\t\t\t\t\t\t\tIDR {currencyFormat(getCashChange(state?.settles, state?.cashPaid), 0)}\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"w-full h-full bg-white rounded-md p-3 flex flex-col items-center justify-center\">\n\t\t\t\t\t\t\t<h1>Sisa Bayar</h1>\n\t\t\t\t\t\t\t<h1 className=\"text-2xl font-semibold capitalize\">\n\t\t\t\t\t\t\t\tIDR {currencyFormat(getBalanceDue(state?.settles, state?.cashPaid), 0)}\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-span-9 row-span-6\">\n\t\t\t\t\t<div className=\"w-full h-full overflow-hidden grid grid-cols-2 gap-5\">\n\t\t\t\t\t\t<div className=\"w-full h-full overflow-scroll\">\n\t\t\t\t\t\t\t<TenderMedia form={form} state={state} setState={setState} handleClickTender={handleClickTender} handleFocus={() => {}} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"w-full h-full overflow-scroll\">\n\t\t\t\t\t\t\t<TableBalanceOrder state={state} setState={setState} handleFocus={() => {}} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-span-3 row-span-4 bg-white border-2 border-gray-400 rounded-md overflow-scroll px-5 py-2\">\n\t\t\t\t\t<DetailBill state={state} />\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<ModalCash\n\t\t\t\tstate={state}\n\t\t\t\thandleState={handleState}\n\t\t\t\thandleCancel={handleCancel}\n\t\t\t\thandlePaymentList={addPaymentList}\n\t\t\t\thandleFocus={() => {}}\n\t\t\t/>\n\t\t\t<ModalCard state={state} setState={setState} handlePaymentList={addPaymentList} handleFocus={() => {}} />\n\t\t\t<ModalCashChange\n\t\t\t\thandlePaymentStore={handlePaymentStore}\n\t\t\t\thandlePrint={() => handlePrint(null, () => componentPrintRef)}\n\t\t\t\topen={state?.modalCashChange}\n\t\t\t\tstate={state}\n\t\t\t\thandleCancel={handleCancel}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n"],"sourceRoot":""}