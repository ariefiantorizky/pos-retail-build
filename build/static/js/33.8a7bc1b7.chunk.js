(this.webpackJsonpPOS_RETAIL=this.webpackJsonpPOS_RETAIL||[]).push([[33],{312:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a(280);var l=a(282),s=(a(281),a(283)),c=(a(1),a(13));function i(e){let{title:t="",value:a="",className:i="",marginRow:r="my-2"}=e;return Object(c.jsx)("div",{className:"w-full ".concat(r),children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(s.a,{span:11,className:"".concat(""!==i?i:"text-base"," capitalize"),children:t}),Object(c.jsx)(s.a,{span:1,className:"".concat(""!==i?i:"text-base"),children:":"}),Object(c.jsx)(s.a,{span:12,className:"".concat(""!==i?i:"text-base"," capitalize"),children:a})]})})}},529:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));a(110);var l=a(64),s=a(148),c=a.n(s),i=a(1),r=a.n(i),n=a(543),d=a(48),o=a(28),j=a(317),m=a(85);function u(){const{reportSalesShift:e={}}=Object(d.e)((e=>null===e||void 0===e?void 0:e.report)),{balance:t=[],cashBalance:a=[],itemCategory:l=[]}=e;return{getBalance:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return 0!==t.length&&e?t.reduce(((t,a)=>t+(a[e]||0)),0):0},getCashBalance:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return 0!==a.length&&e?a.reduce(((t,a)=>t+(a[e]||0)),0):0},getCategoryData:()=>l.reduce(((e,t)=>{const a=e.find((e=>e.cateCode===t.cateCode));return a?(a.grossSales+=t.grossSales,a.salesDiscount+=t.salesDiscount,a.nettSales+=t.nettSales,a.servValue+=t.servValue,a.taxValue+=t.taxValue):e.push({...t}),e}),[])}}var b=a(312),x=a(13);const h=r.a.forwardRef(((e,t)=>{var a;let{titlePrint:l="",...s}=e;const{cashier:i={},property:r={},user:n={}}=JSON.parse(localStorage.getItem("app")||"{}"),{isClosing:o=!1}=i,{reportSalesShift:j={},loadingReportShift:h=!1}=Object(d.e)((e=>null===e||void 0===e?void 0:e.report)),{itemGroup:p=[],itemCategory:O=[],items:v=[],balance:f=[],settlement:g=[]}=j,{getBalance:y,getCategoryData:N,getCashBalance:w}=u();return Object(x.jsxs)("div",{className:"w-full p-3 py-5 bg-white rounded-md mx-auto",style:{maxWidth:"350px"},ref:t,children:[Object(x.jsxs)("div",{children:[Object(x.jsx)("p",{className:"text-center text-print-medium font-bold",children:(null===r||void 0===r?void 0:r.header1)||""}),Object(x.jsx)("p",{className:"text-center text-print-small font-semibold",children:(null===r||void 0===r?void 0:r.header2)||""}),Object(x.jsx)("p",{className:"text-center text-print-xsmall mt-2",children:(null===r||void 0===r?void 0:r.header3)||""}),Object(x.jsx)("p",{className:"text-center text-print-xsmall",children:(null===r||void 0===r?void 0:r.header4)||""}),Object(x.jsx)("p",{className:"text-center text-print-xsmall",children:(null===r||void 0===r?void 0:r.header5)||""}),Object(x.jsx)("p",{className:"text-center text-print-xsmall",children:(null===r||void 0===r?void 0:r.header6)||""})]}),Object(x.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),Object(x.jsx)("div",{children:Object(x.jsx)("p",{className:"text-center text-print-medium mt-3 font-semibold",children:null===l||void 0===l?void 0:l.toUpperCase()})}),Object(x.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),Object(x.jsxs)("div",{children:[Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"nama kasir",value:null===n||void 0===n?void 0:n.username}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"opening shift",value:c()(null===i||void 0===i?void 0:i.shiftDate).format("dddd, DD MMMM YYYY")}),!s.isEndOfDay&&Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"opening cash",value:"IDR ".concat(Object(m.a)(w("beginCash"),0))}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"closing shift",value:c()(null===i||void 0===i?void 0:i.closingDate).format("dddd, DD MMMM YYYY")}),!(null!==s&&void 0!==s&&s.isEndOfDay)&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"closing cash",value:"IDR ".concat(Object(m.a)(w("endCash"),0))}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"total cash",value:"IDR ".concat(Object(m.a)(w("paidValue"),0))}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"different",value:"IDR ".concat(Object(m.a)(w("different"),0))})]}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"subtotal",value:"IDR "+Object(m.a)(y("SubTotal"),0)}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"sales discount",value:"IDR "+Object(m.a)(y("DiscValue"),0)}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"discount bill",value:"IDR "+Object(m.a)(y("DiscBill"),0)}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"rounded",value:"IDR "+Object(m.a)(y("Rounded"),0)}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"service tax",value:"IDR "+Object(m.a)(y("ServValue"),0)}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"tax",value:"IDR "+Object(m.a)(y("TaxValue"),0)}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"grand total",value:"IDR "+Object(m.a)(y("GrandTotal"),0)}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"net sales",value:"IDR "+Object(m.a)(y("NetSales"),0)}),Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:"sales collected",value:"IDR "+Object(m.a)(y("SalesCollected"),0)})]}),Object(x.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{className:"w-full mb-3",children:Object(x.jsx)("h1",{className:"text-center text-print-small font-semibold uppercase",children:"SETTLEMENTS"})}),Object(x.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),null===g||void 0===g?void 0:g.map((e=>{let{CardName:t="",PaidValue:a=0}=e;return Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:t.trim(),value:"IDR ".concat(Object(m.a)(a,0))})}))]}),Object(x.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("h1",{className:"text-center text-print-small font-semibold uppercase",children:"GROUP"}),Object(x.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),null===p||void 0===p?void 0:p.map((e=>{let{groupCode:t="",groupName:a="",nettSales:l=0}=e;return Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:a,value:"IDR ".concat(Object(m.a)(l,0))})}))]}),Object(x.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("h1",{className:"text-center text-print-small font-semibold uppercase",children:"category"}),Object(x.jsx)("div",{className:"my-3 w-full border border-separate border-gray-400"}),null===(a=N())||void 0===a?void 0:a.map((e=>{let{cateName:t="",nettSales:a=0}=e;return Object(x.jsx)(b.a,{marginRow:"my-1",className:"text-print-xsmall",title:t,value:"IDR ".concat(Object(m.a)(a,0))})}))]})]})}));function p(e){var t;let{isOpening:a=!1,isClosing:s=!1,isEndOfDay:r=!1,...p}=e;const O=Object(o.useHistory)(),v=Object(d.d)();let f=Object(i.useRef)();const{cashier:g={},user:y={}}=JSON.parse(localStorage.getItem("app")||"{}"),{reportSalesShift:N={},loadingReportShift:w=!1}=Object(d.e)((e=>null===e||void 0===e?void 0:e.report)),{itemGroup:R=[],settlement:D=[],cashBalance:I=[]}=N,{getBalance:S,getCashBalance:C,getCategoryData:k}=u(),E=Object(j.useReactToPrint)({content:()=>f.current,onPrintError:e=>console.log("Error Print!",e),removeAfterPrint:!0,copyStyles:!0});return Object(x.jsx)("div",{className:"w-full h-auto",children:Object(x.jsxs)("div",{className:"w-full mt-7 grid grid-cols-12 gap-5",children:[Object(x.jsxs)("div",{className:"col-span-8",children:[Object(x.jsx)("div",{className:"mb-5",children:Object(x.jsx)(l.a,{className:"btn-page w-1/2",loading:w,disabled:w,onClick:()=>{s?v({type:"report/SALES_BY_SHIFT",payload:{refDate:null===g||void 0===g?void 0:g.shiftDate,shiftId:null===g||void 0===g?void 0:g.shiftId}}):r&&v({type:"report/SALES_BY_SHIFT",payload:{refDate:null===g||void 0===g?void 0:g.shiftDate,shiftId:"all"}})},children:"Refresh"})}),Object(x.jsxs)("div",{className:"w-full",children:[Object(x.jsx)("div",{className:"",children:Object(x.jsx)("h1",{className:"text-lg font-semibold",children:"Report Cashier"})}),Object(x.jsxs)("div",{className:"mt-3",children:[Object(x.jsx)(b.a,{title:"nama kasir",value:null===y||void 0===y?void 0:y.username}),Object(x.jsx)(b.a,{title:"opening shift",value:c()(null===g||void 0===g?void 0:g.shiftDate).format("dddd, DD MMMM YYYY")}),!r&&Object(x.jsx)(b.a,{title:"opening cash",value:"IDR ".concat(Object(m.a)(C("beginCash"),0))}),Object(x.jsx)(b.a,{title:"closing shift",value:c()(null===I||void 0===I?void 0:I.refDate).format("dddd, DD MMMM YYYY")}),!r&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.a,{title:"closing cash",value:"IDR ".concat(Object(m.a)(C("endCash"),0))}),Object(x.jsx)(b.a,{title:"total cash",value:"IDR ".concat(Object(m.a)(C("paidValue"),0))}),Object(x.jsx)(b.a,{title:"different",value:"IDR ".concat(Object(m.a)(C("different"),0))})]})]})]}),Object(x.jsx)("div",{className:"w-full bg-gray-400 my-4",style:{height:"1px"}}),Object(x.jsxs)("div",{className:"w-full",children:[Object(x.jsx)("div",{className:"",children:Object(x.jsx)("h1",{className:"text-lg font-semibold",children:"Report Sales Balancing"})}),Object(x.jsxs)("div",{className:"mt-3",children:[Object(x.jsx)(b.a,{title:"subtotal",value:"IDR "+Object(m.a)(S("SubTotal"),0)}),Object(x.jsx)(b.a,{title:"sales discount",value:"IDR "+Object(m.a)(S("DiscValue"),0)}),Object(x.jsx)(b.a,{title:"discount bill",value:"IDR "+Object(m.a)(S("DiscBill"),0)}),Object(x.jsx)(b.a,{title:"rounded",value:"IDR "+Object(m.a)(S("Rounded"),0)}),Object(x.jsx)(b.a,{title:"service tax",value:"IDR "+Object(m.a)(S("ServValue"),0)}),Object(x.jsx)(b.a,{title:"tax",value:"IDR "+Object(m.a)(S("TaxValue"),0)}),Object(x.jsx)(b.a,{title:"grand total",value:"IDR "+Object(m.a)(S("GrandTotal"),0)}),Object(x.jsx)(b.a,{title:"net sales",value:"IDR "+Object(m.a)(S("NetSales"),0)}),Object(x.jsx)(b.a,{title:"sales collected",value:"IDR "+Object(m.a)(S("SalesCollected"),0)})]})]}),Object(x.jsx)("div",{className:"w-full bg-gray-400 my-4",style:{height:"1px"}}),Object(x.jsxs)("div",{className:"w-full",children:[Object(x.jsx)("div",{className:"",children:Object(x.jsx)("h1",{className:"text-lg font-semibold",children:"Report Sales Settlements"})}),Object(x.jsx)("div",{className:"mt-3",children:null===D||void 0===D?void 0:D.map((e=>{let{CardName:t="",PaidValue:a=0}=e;return Object(x.jsx)(b.a,{title:t.trim(),value:"IDR ".concat(Object(m.a)(a,0))})}))})]}),Object(x.jsx)("div",{className:"w-full bg-gray-400 my-4",style:{height:"1px"}}),Object(x.jsxs)("div",{className:"w-full",children:[Object(x.jsx)("div",{className:"",children:Object(x.jsx)("h1",{className:"text-lg font-semibold",children:"Report Sales Detail By Group"})}),Object(x.jsx)("div",{className:"mt-3",children:null===R||void 0===R?void 0:R.map((e=>{let{groupName:t="",nettSales:a=0}=e;return Object(x.jsx)(b.a,{title:t||"-",value:"IDR ".concat(Object(m.a)(a,0))})}))})]}),Object(x.jsxs)("div",{className:"w-full",children:[Object(x.jsx)("div",{className:"",children:Object(x.jsx)("h1",{className:"text-lg font-semibold",children:"Report Sales Detail By Category"})}),Object(x.jsx)("div",{className:"mt-3",children:null===(t=k())||void 0===t?void 0:t.map((e=>{let{cateName:t,nettSales:a}=e;return Object(x.jsx)(b.a,{title:t||"-",value:"IDR ".concat(Object(m.a)(a,0))})}))})]})]}),Object(x.jsxs)("div",{className:"col-span-4",children:[Object(x.jsxs)("div",{className:"w-full mb-3 flex items-center gap-2",children:[Object(x.jsx)(l.a,{className:"flex btn-page px-5 w-max bg-transparent border border-blue-600 text-primary",icon:Object(x.jsx)(n.a,{className:"text-blue-600"}),onClick:()=>O.push("/pos/options")}),Object(x.jsxs)(l.a,{className:"btn-page",onClick:e=>E(e,(()=>f)),children:["PRINT ",s?"CLOSING SHIFT":r?"END OF DAY":"REPORT"]})]}),Object(x.jsx)("div",{className:"w-full",children:Object(x.jsx)(h,{isOpening:a,isClosing:s,isEndOfDay:r,ref:e=>f=e,titlePrint:"REPORT ".concat(s?"CLOSING SHIFT":r?"END OF DAY":"REPORT")})})]})]})})}},825:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return b}));a(280);var l=a(282),s=(a(281),a(283)),c=(a(110),a(64)),i=(a(196),a(140)),r=(a(197),a(86)),n=a(1),d=a(637),o=a(48),j=a(28),m=a(529),u=a(13);function b(){const e=Object(o.d)(),t=Object(j.useHistory)(),a=Object(n.useRef)(null),b=Object(n.useRef)(null),x=Object(n.useRef)(null),[h]=r.a.useForm(),{loading:p=!1,isGrantedAccess:O=!1}=Object(o.e)((e=>null===e||void 0===e?void 0:e.auth)),{loading:v=!1,transactionHolds:f=[]}=Object(o.e)((e=>null===e||void 0===e?void 0:e.transaction)),{cashier:g={}}=JSON.parse(localStorage.getItem("app")||"{}"),{isClosing:y=!1}=g,N=a=>{O?D(a):(e({type:"auth/USER_ACCESS",payload:{email:null===a||void 0===a?void 0:a.email,password:window.btoa(null===a||void 0===a?void 0:a.password),funcId:"1038"},history:t}),e({type:"transaction/HOLD_LIST"}))},w=e=>console.log("Error! ",e),R=e=>{if(O)"Escape"===e.key&&(x.current.blur(),x.current.value=""),x&&x.current&&x.current.focus();else{const l=document.activeElement===(null!==a.current&&a.current.input)||!1,s=document.activeElement===(null!==b.current&&b.current.input)||!1;if("Enter"===e.key&&l)return a.current.blur(),void b.current.focus();if("Enter"===e.key&&s)return a.current.blur(),void b.current.focus();"Escape"===e.key&&(t.push("/pos/options"),h.resetFields()),"ArrowUp"===e.key&&a.current.focus(),"ArrowDown"===e.key&&(b.current.focus(),s&&(b.current.blur(),a.current.blur()))}},D=a=>{const l=JSON.parse(localStorage.getItem("app")||"{}"),{cashier:s={},property:c={}}=l,i={refDate:(null===s||void 0===s?void 0:s.shiftDate)||(null===c||void 0===c?void 0:c.refDate)||"",closeCash:(null===a||void 0===a?void 0:a.closingCash)||0,shiftId:(null===s||void 0===s?void 0:s.shiftId)||(null===c||void 0===c?void 0:c.shiftId)||0};e({type:"transaction/CLOSING_SHIFT",payload:i,history:t,property:c})};return Object(n.useEffect)((()=>(document.addEventListener("keydown",R),e({type:"auth/SET_STATE",payload:{isGrantedAccess:!1}}),()=>{document.removeEventListener("keydown",R)})),[h]),Object(n.useEffect)((()=>{e({type:"report/SALES_BY_SHIFT",payload:{refDate:null===g||void 0===g?void 0:g.shiftDate,shiftId:null===g||void 0===g?void 0:g.shiftId}})}),[y]),Object(u.jsx)("div",{className:"w-full h-screen overflow-y-scroll",children:Object(u.jsx)("div",{className:"w-full h-full flex flex-col items-center justify-center",children:Object(u.jsxs)("div",{className:"".concat(y?"w-2/3 h-full py-10":"max-w-xl"),children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-2xl font-medium",children:"Closing Shift"}),Object(u.jsx)("p",{className:"text-base leading-snug mt-3",children:"Jangan lupa untuk menutup kasir jika waktu kasir anda sudah selesai. Setelah itu, mohon untuk melakukan pengecekan pada histori transaksi dan upload sales."})]}),y?Object(u.jsx)(m.a,{isClosing:!0}):O?Object(u.jsxs)("div",{className:"w-full h-auto mt-5",children:[0!==(null===f||void 0===f?void 0:f.length)?Object(u.jsxs)("div",{className:"w-full h-auto p-5 mb-5 bg-red-100 rounded-md flex items-center justify-start gap-3",children:[Object(u.jsx)("div",{children:Object(u.jsx)(d.a,{className:"text-red-600 text-3xl"})}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-base font-medium",children:"Perhatian!"}),Object(u.jsx)("p",{children:"Anda masih mempunyai transaksi yang tersimpan atau transaksi yang belum diupload. Mohon periksa kembali, dan pastikan semuanya sudah benar."})]})]}):Object(u.jsxs)("div",{className:"w-full h-auto p-5 mb-5 bg-yellow-200 rounded-md flex items-center justify-start gap-3",children:[Object(u.jsx)("div",{children:Object(u.jsx)(d.a,{className:"text-yellow-600 text-3xl"})}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:"text-base font-medium",children:"Perhatian!"}),Object(u.jsx)("p",{children:"Sebelum melakukan closing shift, mohon untuk memeriksa seluruh transaksi. Periksa apakah terdapat transaksi yang masih tersimpan atau belum terupload."})]})]}),Object(u.jsxs)(r.a,{form:h,name:"opening",layout:"vertical",initialValues:{remember:!0},onFinish:N,onFinishFailed:w,autoComplete:"off",style:{maxWidth:"none",width:"100%"},children:[Object(u.jsx)(r.a.Item,{children:Object(u.jsx)(r.a.Item,{label:"Saldo Akhir",name:"closingCash",rules:[{required:!0,message:"Wajid Diisi!"}],children:Object(u.jsx)(i.a,{defaultValue:0,ref:x,type:"number",autoFocus:!0,autoComplete:"false",placeholder:"0",prefix:"IDR ",className:"w-full h-14 rounded-md"})})}),Object(u.jsxs)("div",{className:"w-full flex items-center justify-start gap-2 mt-3",children:[Object(u.jsx)(r.a.Item,{children:Object(u.jsx)(c.a,{disabled:v,loading:v,htmlType:"submit",className:"btn-page",children:"Tutup Kasir"})}),Object(u.jsx)(r.a.Item,{children:Object(u.jsx)(c.a,{disabled:v,htmlType:"button",className:"btn-page bg-transparent text-gray-700",onClick:()=>t.push("/pos/options"),children:"Batalkan"})})]})]})]}):Object(u.jsx)("div",{className:"w-3/4 my-7",children:Object(u.jsx)(r.a,{form:h,name:"login",layout:"vertical",initialValues:{remember:!0},onFinish:N,onFinishFailed:w,autoComplete:"off",style:{maxWidth:"none",width:"100%"},children:Object(u.jsxs)(l.a,{wrap:!0,gutter:[8,0],children:[Object(u.jsx)(s.a,{span:24,children:Object(u.jsx)(r.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Wajib Diisi!"}],children:Object(u.jsx)(i.a,{ref:a,type:"email",autoFocus:!0,autoComplete:"false",placeholder:"usertest@domain.com",className:"w-full h-12 rounded-md"})})}),Object(u.jsx)(s.a,{span:24,children:Object(u.jsx)(r.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Wajib Diisi!"}],children:Object(u.jsx)(i.a.Password,{ref:b,type:"password",autoComplete:"false",placeholder:"********",className:"w-full h-12 rounded-md"})})}),Object(u.jsx)(s.a,{span:18,children:Object(u.jsxs)("div",{className:"w-full flex items-center justify-start gap-2 mt-3",children:[Object(u.jsx)(r.a.Item,{children:Object(u.jsx)(c.a,{disabled:p,loading:p,type:"primary",htmlType:"submit",className:"w-full bg-primary h-12 rounded-md hover:bg-blue-900",children:"Validasi Kasir"})}),Object(u.jsx)(r.a.Item,{children:Object(u.jsxs)(c.a,{disabled:p,type:"default",htmlType:"button",className:"w-full h-12 flex items-center justify-center gap-2 rounded-md",onClick:()=>t.push("/pos/options"),children:["Kembali ",Object(u.jsx)("kbd",{className:"kbd",children:"esc"})]})})]})})]})})})]})})})}}}]);
//# sourceMappingURL=33.8a7bc1b7.chunk.js.map